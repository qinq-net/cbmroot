
Processing run_reco.C...
[INFO   ] FairRootManager::OpenOutFile("Sim_Outputs/PMTMapping/Rec_RichGeo_jordan_testPmtRot.root")
In CheckDetectorPresence for detector trd
Info in <TGeoManager::CloseGeometry>: Geometry loaded from file...
Info in <TGeoManager::SetTopVolume>: Top volume is cave. Master volume is cave
Info in <TGeoNavigator::BuildCache>: --- Maximum geometry depth set to 100
Info in <TGeoManager::Voxelize>: Voxelizing...
Info in <TGeoManager::CountLevels>: max level = 8, max placements = 32
Info in <TGeoManager::CloseGeometry>: 21230 nodes/ 446 volume UID's in FAIR geometry
Info in <TGeoManager::CloseGeometry>: ----------------modeler ready----------------
After getting the geomanager trd
Node: PIPE_v14y_0
Node: magnet_v15a_0
Node: sts_v15b_0
Node: rich1_0
In CheckDetectorPresence for detector rich
After getting the geomanager rich
Node: PIPE_v14y_0
Node: magnet_v15a_0
Node: sts_v15b_0
Node: rich1_0
[INFO   ] The input consists out of the following trees and files: 
[INFO   ]  - cbmsim
[INFO   ]     - Sim_Outputs/PMTMapping/Sim_RichGeo_jordan_testPmtRot.root
[INFO   ] Parameter and input file are available, Assure that basic info is there for the run!
[INFO   ] The number of entries in the tree is 10
[INFO   ] FairRootManager::ReadEvent(0): The tree has 10 entries
[INFO   ]  Branch: EventHeader. not found in Tree.
[INFO   ]  Branch: EventHeader. not found in Tree.
[INFO   ] No event Header was found!!!
[INFO   ]  Branch: EventHeader. not found in Tree.
[INFO   ]  Branch: EventHeader. not found in Tree.

************************************************************* 
     initialisation for run id 1449502712
************************************************************* 
-I- FairRunTimeDB::InitContainer() FairGeoParSet
Warning in <TGeoManager::Init>: Deleting previous geometry: FAIRGeom/FAIR geometry
Info in <TGeoManager::CloseGeometry>: Geometry loaded from file...
Info in <TGeoManager::SetTopVolume>: Top volume is cave. Master volume is cave
Info in <TGeoManager::Voxelize>: Voxelizing...
Info in <TGeoManager::CountLevels>: max level = 8, max placements = 32
Info in <TGeoManager::CloseGeometry>: 21230 nodes/ 446 volume UID's in FAIR geometry
Info in <TGeoManager::CloseGeometry>: ----------------modeler ready----------------
Container FairGeoParSet initialized from ROOT file.
-I- FairRunTimeDB::InitContainer() FairBaseParSet
Container FairBaseParSet initialized from ROOT file.
 -I container name CbmGeoMuchPar
Error in <FairRuntimeDb::getContainer(Text_t*)>: Container CbmGeoTofPar not created!
Error in <FairRuntimeDb::getContainer(Text_t*)>: Container CbmGeoSttPar not created!
[INFO   ] create CbmFieldPar container CbmFieldPar
Error in <FairRuntimeDb::getContainer(Text_t*)>: Container CbmGeoStsPar not created!
Error in <FairRuntimeDb::getContainer(Text_t*)>: Container CbmGeoStsPar not created!
Error in <FairRuntimeDb::getContainer(Text_t*)>: Container CbmStsDigiPar not created!

************************************************************* 
     initialisation for run id 1449502712
************************************************************* 
-I- FairRunTimeDB::InitContainer() FairGeoParSet
-I- FairRunTimeDB::InitContainer() FairBaseParSet
-I- FairRunTimeDB::InitContainer() CbmGeoPassivePar
Container CbmGeoPassivePar initialized from ROOT file.
-I- FairRunTimeDB::InitContainer() CbmMvdGeoPar
[ERROR  ] init() CbmMvdGeoPar  not initialized 
-I- FairRunTimeDB::InitContainer() CbmGeoTrdPar
[ERROR  ] init() CbmGeoTrdPar  not initialized 
-I- FairRunTimeDB::InitContainer() CbmGeoRichPar
[ERROR  ] init() CbmGeoRichPar  not initialized 
-I- FairRunTimeDB::InitContainer() CbmGeoMuchPar
[ERROR  ] init() CbmGeoMuchPar  not initialized 
-I- FairRunTimeDB::InitContainer() CbmFieldPar
Container CbmFieldPar initialized from ROOT file.
Error in <FairRuntimeDb::initContainers()>: Error occured during initialization
New field at 0x2517fa0, type 2
[INFO   ] CbmFieldMap: Reading field map from ROOT file /data/cbm/cbmroot/input/field_v12a.root

[INFO   ] ==========================================================
[INFO   ] StsDigitize: Initialisation
[INFO   ] 

[INFO   ] ==========================================================
[INFO   ] Initialising STS Setup from TGeoManager
[INFO   ] STS: Reading geometry from TGeoManager FAIRGeom
[INFO   ] STS: STS top node is sts_v15b_0
[INFO   ] STS: Elements in setup: 
[INFO   ]      stations        8
[INFO   ]      ladders       106
[INFO   ]      halfladders   212
[INFO   ]      modules       900
[INFO   ]      sensors      1220
[INFO   ] Instantiating STS Physics... 
[INFO   ] StsPhysics:    87 values read from /data/cbm/cbmroot/parameters/sts/dEdx_Si_e.txt
[INFO   ] StsPhysics:   138 values read from /data/cbm/cbmroot/parameters/sts/dEdx_Si_p.txt
[INFO   ] StsPhysics: Urban parameters for z = 14 :
[INFO   ] I = 172.042 eV, Emax = 1e+06 eV, E1 = 114.692 eV, E2 = 1960 eV, f1 = 0.857143, f2 = 0.142857, r = 0.4
[INFO   ] STS: 9 sensor types in database
[INFO   ] STS: Set types for 1220 sensors
[INFO   ] ==========================================================

[INFO   ] StsDigitize: Detector response model SIMPLE
[INFO   ] StsDigitize: Sensor operation conditions :
[INFO   ] 	 Depletion voltage               70 V
[INFO   ] 	 Bias voltage                   140 V
[INFO   ] 	 Temperature                    268
[INFO   ] 	 Coupling capacitance          17.5 pF
[INFO   ] 	 Inter-strip capacitance          1 pF
[INFO   ] StsDigitize: Set conditions for 1220 sensors 
[INFO   ] StsDigitize: Digitisation parameters :
[INFO   ] 	 Dynamic range        40960 e
[INFO   ] 	 Threshold             4000 e
[INFO   ] 	 ADC channels          4096
[INFO   ] 	 Time resolution          5 ns
[INFO   ] 	 Dead time            1e+07 ns
[INFO   ] 	 ENC                      0 e
[INFO   ] 	 Dead channel fraction          0 %
[INFO   ] StsDigitize: Set parameters for 900 modules 
[INFO   ] StsDigitize: Using event mode.
[INFO   ] StsDigitize: Initialisation successful
[INFO   ] ==========================================================

[INFO   ] StsFindClusters: Initialisation successful
[INFO   ] StsFindHits: Initialisation successful
KALMAN FILTER : === INIT MAGNETIC FIELD ===
Magnetic field done
[INFO   ]  Branch: MvdPoint not found in Tree.
[INFO   ]  Branch: MvdPoint not found in Tree.
KALMAN FILTER : === READ STS MATERIAL ===
 Sts material ( id, z, dz, r, R, RadL, dz/RadL )= ( 1000, 30, 0.03, 0, 23.7868, 9.34953, 0.00320872 )
 Sts material ( id, z, dz, r, R, RadL, dz/RadL )= ( 1001, 40, 0.03, 0, 35.6052, 9.34953, 0.00320872 )
 Sts material ( id, z, dz, r, R, RadL, dz/RadL )= ( 1002, 50, 0.03, 0, 35.6052, 9.34953, 0.00320872 )
 Sts material ( id, z, dz, r, R, RadL, dz/RadL )= ( 1003, 60, 0.03, 0, 41.5144, 9.34953, 0.00320872 )
 Sts material ( id, z, dz, r, R, RadL, dz/RadL )= ( 1004, 70, 0.03, 0, 41.5144, 9.34953, 0.00320872 )
 Sts material ( id, z, dz, r, R, RadL, dz/RadL )= ( 1005, 80, 0.03, 0, 41.5144, 9.34953, 0.00320872 )
 Sts material ( id, z, dz, r, R, RadL, dz/RadL )= ( 1006, 90, 0.03, 0, 47.4236, 9.34953, 0.00320872 )
 Sts material ( id, z, dz, r, R, RadL, dz/RadL )= ( 1007, 100, 0.03, 0, 48, 9.34953, 0.00320872 )
KALMAN FILTER : === READ RICH MATERIAL ===
KALMAN FILTER : === READ TRD PASSIVE MATERIAL ===
printout skipped for Verbose mode 1
KALMAN FILTER : === READ TRD DETECTORS ===
KALMAN FILTER : === READ MUCH PASSIVE MATERIAL ===
KALMAN FILTER : === READ MUCH DETECTORS ===
KALMAN FILTER : === READ BEAM PIPE MATERIAL ===
KALMAN FILTER : === READ TARGET MATERIAL ===
[INFO   ]  Branch: MvdHit not found in Tree.
[INFO   ]  Branch: MvdHit not found in Tree.
L1Algo Input Magnetic field:0 0 -8.34485 0
L1Algo Input Magnetic field:2.5 0 -8.57669 -2.46004e-17
L1Algo Input Magnetic field:5 0 -8.80321 -1.53177e-17
L1Algo Input 8 Stations:
    30 0.03 9.34953, 21 field coeff.
       0 0.00167432 0.1309 0.00167432
    40 0.03 9.34953, 21 field coeff.
       3.14159 0.00167432 3.27249 0.00167432
    50 0.03 9.34953, 21 field coeff.
       0 0.00167432 0.1309 0.00167432
    60 0.03 9.34953, 21 field coeff.
       0 0.00167432 0.1309 0.00167432
    70 0.03 9.34953, 21 field coeff.
       3.14159 0.00167432 3.27249 0.00167432
    80 0.03 9.34953, 21 field coeff.
       0 0.00167432 0.1309 0.00167432
    90 0.03 9.34953, 21 field coeff.
       0 0.00167432 0.1309 0.00167432
    100 0.03 9.34953, 21 field coeff.
       3.14159 0.00167432 3.27249 0.00167432
L1Algo initialized
No MVD material budget file is found. Homogenious budget will be used
STS Material budget file is /data/cbm/cbmroot/parameters/sts/sts_matbudget_v13d.root.

---------------------------------------------
-I- Initialising STSFindTracks ....
[INFO   ]  Branch: MvdHit not found in Tree.
[INFO   ]  Branch: MvdHit not found in Tree.
-W- STSFindTracks::Init: No MVD hits available!
     Running track finding without MVD hits
-I- Track finder engine STS Track Finder L1 selected
-I- STSFindTracks intialised 
---------------------------------------------
-I- CBM detector setup information: 
   Electron setup detected 
   Detectors found in setup: STS RICH 
[INFO   ]  Branch: PrimaryVertex not found in Tree.
[INFO   ]  Branch: PrimaryVertex not found in Tree.
-I- CbmRichHitProducer::InitRootGeometry

-I- RICH geometry parameters
PMT position in (x,y,z) [cm]: 51  135.197  207.021
Tilted PMT position in (x,y,z) [cm]: 32.7629  151.31  199.421
PMT size in x and y [cm]: 50  30
PMT was tilted around x by 4.5 degrees
PMT was tilted around y by -5 degrees
Refractive index for lowest photon energies: 1.00045, (n-1)*10000: 4.46242
Mirror center (x,y,z): 0 98.1556 49.6359
Mirror radius: 300
Mirror tilting angle: -1.5578 degrees

CbmRichReconstruction::Init
-I- CbmRichHitProducer::InitRootGeometry

-I- RICH geometry parameters
PMT position in (x,y,z) [cm]: 51  135.197  207.021
Tilted PMT position in (x,y,z) [cm]: 32.7629  151.31  199.421
PMT size in x and y [cm]: 50  30
PMT was tilted around x by 4.5 degrees
PMT was tilted around y by -5 degrees
Refractive index for lowest photon energies: 1.00045, (n-1)*10000: 4.46242
Mirror center (x,y,z): 0 98.1556 49.6359
Mirror radius: 300
Mirror tilting angle: -1.5578 degrees

   use tracks in imaginary plane for projection to photodetector plane
-I- CbmRichRingSelectNeuralNet: get NeuralNet weight parameters from: /data/cbm/cbmroot/parameters/rich/rich_select_ann_weights.txt
[INFO   ]  Branch: TrdTrack not found in Tree.
[INFO   ]  Branch: TrdTrack not found in Tree.
Warning in <TROOT::Append>: Replacing existing TH1: fhDistanceCenterToExtrapolatedTrackInPlane (Potential memory leak).
InitBranch: MCTrack 0x1219a380
InitBranch: StsPoint 0x1219b2d0
[INFO   ]  Branch: TrdPoint not found in Tree.
[INFO   ]  Branch: TrdPoint not found in Tree.
[INFO   ]  Branch: TrdDigi not found in Tree.
[INFO   ]  Branch: TrdDigi not found in Tree.
[INFO   ]  Branch: TrdCluster not found in Tree.
[INFO   ]  Branch: TrdCluster not found in Tree.
[INFO   ]  Branch: TrdHit not found in Tree.
[INFO   ]  Branch: TrdHit not found in Tree.
[INFO   ]  Branch: TrdTrack not found in Tree.
[INFO   ]  Branch: TrdTrack not found in Tree.
[INFO   ]  Branch: TrdDigiMatch not found in Tree.
[INFO   ]  Branch: TrdDigiMatch not found in Tree.
[INFO   ]  Branch: MuchPoint not found in Tree.
[INFO   ]  Branch: MuchPoint not found in Tree.
[INFO   ]  Branch: MuchDigi not found in Tree.
[INFO   ]  Branch: MuchDigi not found in Tree.
[INFO   ]  Branch: MuchStrawDigi not found in Tree.
[INFO   ]  Branch: MuchStrawDigi not found in Tree.
[INFO   ]  Branch: MuchCluster not found in Tree.
[INFO   ]  Branch: MuchCluster not found in Tree.
[INFO   ]  Branch: MuchPixelHit not found in Tree.
[INFO   ]  Branch: MuchPixelHit not found in Tree.
[INFO   ]  Branch: MuchStrawHit not found in Tree.
[INFO   ]  Branch: MuchStrawHit not found in Tree.
[INFO   ]  Branch: MuchTrack not found in Tree.
[INFO   ]  Branch: MuchTrack not found in Tree.
[INFO   ]  Branch: MuchDigiMatch not found in Tree.
[INFO   ]  Branch: MuchDigiMatch not found in Tree.
[INFO   ]  Branch: MuchStrawDigiMatch not found in Tree.
[INFO   ]  Branch: MuchStrawDigiMatch not found in Tree.
[INFO   ]  Branch: MvdPoint not found in Tree.
[INFO   ]  Branch: MvdPoint not found in Tree.
[INFO   ]  Branch: MvdHit not found in Tree.
[INFO   ]  Branch: MvdHit not found in Tree.
[INFO   ]  Branch: MvdCluster not found in Tree.
[INFO   ]  Branch: MvdCluster not found in Tree.
[INFO   ]  Branch: MvdDigiMatch not found in Tree.
[INFO   ]  Branch: MvdDigiMatch not found in Tree.
[INFO   ]  Branch: TofPoint not found in Tree.
[INFO   ]  Branch: TofPoint not found in Tree.
[INFO   ]  Branch: TofDigi not found in Tree.
[INFO   ]  Branch: TofDigi not found in Tree.
[INFO   ]  Branch: TofHit not found in Tree.
[INFO   ]  Branch: TofHit not found in Tree.
[INFO   ]  Branch: TofDigiMatchPoints not found in Tree.
[INFO   ]  Branch: TofDigiMatchPoints not found in Tree.
[INFO   ]  Branch: TofDigiMatch not found in Tree.
[INFO   ]  Branch: TofDigiMatch not found in Tree.
Starting run
[INFO   ] The number of entries in the tree is 10
[INFO   ] FairRootManager::ReadEvent(0): The tree has 10 entries
[INFO   ] + StsDigitize         : step       0, time 0.084915 s, points: 18, signals: 64 / 60, digis: 43
[INFO   ] + StsFindClusters     : Event      0, time 0.000096 s, digis: 43, clusters: 25
[INFO   ] + StsFindHits         : Event      0, time 0.000070 s, clusters: 25, hits: 21
-I- CbmLitFindGlobalTracks: Number of STS tracks: 2
-I- CbmLitFindGlobalTracks: Number of hits: 0
CbmLitFindGlobalTracks::Exec event: 0

-------------------------------------------------------
-I-             Primary Vertex Finder               -I-
Vertex coord. (-0.002667,0.001529,0.070388) cm, chi2/ndf = 0.865206, 2 tracks used
-------------------------------------------------------
-I- CbmRichHitProducer, event no 1
SetPhotoDetPar routine called for PMT type 4
Nof hits: 43
Fraction of double hits: 0.511628
Nof crosstalk hits: 0.000000
CbmRichProjectionProducer: event 1
CbmRichRingFinderHough. Number of found rings 1

//--------------------------------------------------------------------------------------------------------------//
//---------------------------------------- EXEC Function - Defining the entries ----------------------------------------//
//----------------------------------------------------------------------------------------------------------------------//
CbmRichPMTMapping : Event #1
Nb of rings in evt = 1, nb of mirror points = 2, nb of hits in evt = 43, nb of Monte-Carlo points = 542 and nb of Monte-Carlo tracks = 544

//----------------------------------------------------------------------------------------------------------//
//---------------------------------------- EXEC Function ---------------------------------------------------//
//------------------------------ Mapping for mirror - PMT relations ----------------------------------------//
//----------------------------------------------------------------------------------------------------------//

-I- CbmRichHitProducer::InitRootGeometry

-I- RICH geometry parameters
PMT position in (x,y,z) [cm]: 51.000000  135.196678  207.021121
Tilted PMT position in (x,y,z) [cm]: 32.762850  151.309540  199.421426
PMT size in x and y [cm]: 50.000000  30.000000
PMT was tilted around x by 4.500000 degrees
PMT was tilted around y by -5.000000 degrees
Refractive index for lowest photon energies: 1.000446, (n-1)*10000: 4.462420
Mirror center (x,y,z): 0.000000 98.155617 49.635877
Mirror radius: 300.000000
Mirror tilting angle: -1.557800 degrees

//------------------------------ CbmRichPMTMapping: Projection Producer ------------------------------//

Calculated normal vector to PMT plane = {0.087154, 0.078161, -0.993124} and constante d = 199.475425

Top node path: cave_1 and mirror path: RICH_mirror_2_16
Mirror matrix parameters: 
matrix c1115 - tr=1  rot=1  refl=0  scl=0
  1.000000    0.000000    0.000000    Tx =   0.000000
  0.000000    1.000000    0.000000    Ty =  -0.000000
  0.000000    0.000000    1.000000    Tz =  -0.000000
Shape of the mirror tile:
==> Dumping object at: 0x00000000024b0e00, name=RICH_mirror_2_PartBody, class=TGeoSphere

fNz                           80                  number of z planes for drawing
fNseg                         80                  number of segments for drawing
fRmin                         300                 inner radius
fRmax                         300.6               outer radius
fTheta1                       90.038              lower theta limit
fTheta2                       98.156              higher theta limit
fPhi1                         355.93              lower phi limit
fPhi2                         364.07              higher phi limit
fDX                           2.19161             X half-length
fDY                           21.3351             Y half-length
fDZ                           21.2234             Z half-length
fOrigin[3]                    298.408             box origin
fShapeId                      256                 shape id
fShapeBits                    5134                shape bits
fName                         RICH_mirror_2_PartBoobject identifier
fTitle                                            object title
fUniqueID                     602                 object unique identifier
fBits                         0x03000000          bit field status word

Sphere center coordinates of the rotated mirror tile = {0.000000, 98.155617, 49.635877} and sphere inner radius = 300.000000
Reflective Plane Point coordinates = {-12.012083, 56.243828, 270.354767}
Mirror Point coordinates = {-15.253516, 72.423958, 348.141174}

Calculated and normalized normal of mirror tile = {0.050845, 0.085772, -0.995017}
Coordinates of point R2 on reflective plane after reflection on the mirror tile:
* using mirror point M to define Δ: {-10.748636, 101.671599, 274.335279}
* using sphere center C to define Δ: {-10.748636, 101.671599, 274.335279}

Coordinates of point P on PMT plane, after reflection on the mirror tile and extrapolation to the PMT plane:
* using mirror point M to define 𝒟 ': {-6.837481, 127.064519, 210.256706}
* using reflected point R2 to define 𝒟 ': {-6.837481, 127.064519, 210.256706}
Check whether extrapolated track point on PMT plane verifies its equation (value should be 0.):
* using mirror point M, checkCalc = -0.000000
* using reflected point R2, checkCalc = -0.000000
New coordinates of point P on PMT plane, after PMT plane rotation = {-6.529462, 143.153354, 199.435652}

Ring center coordinates = {-6.543685, 143.214569, 211.553527}
Difference in X = 0.014223	Difference in Y = 0.061215	Difference in Z = 12.117875
Distance between fitted ring center and extrapolated track hit = 12.118038
Distance between fitted ring center and extrapolated track hit in plane = 0.062846

End of loop on global tracks;
----------------------------------- End of loop N°1 on the mirror points. -----------------------------------

Top node path: cave_1 and mirror path: RICH_mirror_2_16
Mirror matrix parameters: 
matrix c1115 - tr=1  rot=1  refl=0  scl=0
  1.000000    0.000000    0.000000    Tx =   0.000000
  0.000000    1.000000    0.000000    Ty =  -0.000000
  0.000000    0.000000    1.000000    Tz =  -0.000000
Shape of the mirror tile:
==> Dumping object at: 0x00000000024b0e00, name=RICH_mirror_2_PartBody, class=TGeoSphere

fNz                           80                  number of z planes for drawing
fNseg                         80                  number of segments for drawing
fRmin                         300                 inner radius
fRmax                         300.6               outer radius
fTheta1                       90.038              lower theta limit
fTheta2                       98.156              higher theta limit
fPhi1                         355.93              lower phi limit
fPhi2                         364.07              higher phi limit
fDX                           2.19161             X half-length
fDY                           21.3351             Y half-length
fDZ                           21.2234             Z half-length
fOrigin[3]                    298.408             box origin
fShapeId                      256                 shape id
fShapeBits                    5134                shape bits
fName                         RICH_mirror_2_PartBoobject identifier
fTitle                                            object title
fUniqueID                     602                 object unique identifier
fBits                         0x03000000          bit field status word

Sphere center coordinates of the rotated mirror tile = {0.000000, 98.155617, 49.635877} and sphere inner radius = 300.000000
Reflective Plane Point coordinates = {-12.207295, 56.220367, 270.354767}
Mirror Point coordinates = {-15.527211, 72.385178, 348.123718}

Calculated and normalized normal of mirror tile = {0.051757, 0.085901, -0.994958}
Coordinates of point R2 on reflective plane after reflection on the mirror tile:
* using mirror point M to define Δ: {-10.963441, 101.634505, 274.340376}
* using sphere center C to define Δ: {-10.963441, 101.634505, 274.340376}

Coordinates of point P on PMT plane, after reflection on the mirror tile and extrapolation to the PMT plane:
* using mirror point M to define 𝒟 ': {-6.998660, 127.044889, 210.241016}
* using reflected point R2 to define 𝒟 ': {-6.998660, 127.044889, 210.241016}
Check whether extrapolated track point on PMT plane verifies its equation (value should be 0.):
* using mirror point M, checkCalc = -0.000000
* using reflected point R2, checkCalc = -0.000000
New coordinates of point P on PMT plane, after PMT plane rotation = {-6.691396, 143.133661, 199.435615}

Ring center coordinates = {-6.543685, 143.214569, 211.553527}
Difference in X = 0.147710	Difference in Y = 0.080908	Difference in Z = 12.117913
Distance between fitted ring center and extrapolated track hit = 12.119083
Distance between fitted ring center and extrapolated track hit in plane = 0.168417

End of loop on global tracks;
----------------------------------- End of loop N°2 on the mirror points. -----------------------------------

[INFO   ] CbmMatchRecoToMC::Exec eventNo=0
FinishEvent
[INFO   ] The number of entries in the tree is 10
[INFO   ] FairRootManager::ReadEvent(1): The tree has 10 entries
[ERROR  ] StsPhysics: z coordinate -0.000154 not inside sensor (d = 0.030000)
[ERROR  ] StsPhysics: z coordinate -0.000154 not inside sensor (d = 0.030000)
[INFO   ] + StsDigitize         : step       1, time 0.048230 s, points: 20, signals: 99 / 96, digis: 104
[INFO   ] + StsFindClusters     : Event      1, time 0.000055 s, digis: 104, clusters: 30
[INFO   ] + StsFindHits         : Event      1, time 0.000029 s, clusters: 30, hits: 27
-I- CbmLitFindGlobalTracks: Number of STS tracks: 2
-I- CbmLitFindGlobalTracks: Number of hits: 0
CbmLitFindGlobalTracks::Exec event: 1

-------------------------------------------------------
-I-             Primary Vertex Finder               -I-
Vertex coord. (0.132464,-0.424212,-2.127294) cm, chi2/ndf = 0.520984, 2 tracks used
-------------------------------------------------------
-I- CbmRichHitProducer, event no 2
SetPhotoDetPar routine called for PMT type 4
Nof hits: 40
Fraction of double hits: 0.550000
Nof crosstalk hits: 0.000000
CbmRichProjectionProducer: event 2
CbmRichRingFinderHough. Number of found rings 1

//--------------------------------------------------------------------------------------------------------------//
//---------------------------------------- EXEC Function - Defining the entries ----------------------------------------//
//----------------------------------------------------------------------------------------------------------------------//
CbmRichPMTMapping : Event #2
Nb of rings in evt = 1, nb of mirror points = 3, nb of hits in evt = 40, nb of Monte-Carlo points = 535 and nb of Monte-Carlo tracks = 538

//----------------------------------------------------------------------------------------------------------//
//---------------------------------------- EXEC Function ---------------------------------------------------//
//------------------------------ Mapping for mirror - PMT relations ----------------------------------------//
//----------------------------------------------------------------------------------------------------------//

-I- CbmRichHitProducer::InitRootGeometry

-I- RICH geometry parameters
PMT position in (x,y,z) [cm]: 51.000000  135.196678  207.021121
Tilted PMT position in (x,y,z) [cm]: 32.762850  151.309540  199.421426
PMT size in x and y [cm]: 50.000000  30.000000
PMT was tilted around x by 4.500000 degrees
PMT was tilted around y by -5.000000 degrees
Refractive index for lowest photon energies: 1.000446, (n-1)*10000: 4.462420
Mirror center (x,y,z): 0.000000 98.155617 49.635877
Mirror radius: 300.000000
Mirror tilting angle: -1.557800 degrees

//------------------------------ CbmRichPMTMapping: Projection Producer ------------------------------//

Calculated normal vector to PMT plane = {-0.087157, -0.078163, 0.993124} and constante d = -199.475113

Top node path: cave_1 and mirror path: RICH_mirror_2_16
Mirror matrix parameters: 
matrix c1115 - tr=1  rot=1  refl=0  scl=0
  1.000000    0.000000    0.000000    Tx =   0.000000
  0.000000    1.000000    0.000000    Ty =  -0.000000
  0.000000    0.000000    1.000000    Tz =  -0.000000
Shape of the mirror tile:
==> Dumping object at: 0x00000000024b0e00, name=RICH_mirror_2_PartBody, class=TGeoSphere

fNz                           80                  number of z planes for drawing
fNseg                         80                  number of segments for drawing
fRmin                         300                 inner radius
fRmax                         300.6               outer radius
fTheta1                       90.038              lower theta limit
fTheta2                       98.156              higher theta limit
fPhi1                         355.93              lower phi limit
fPhi2                         364.07              higher phi limit
fDX                           2.19161             X half-length
fDY                           21.3351             Y half-length
fDZ                           21.2234             Z half-length
fOrigin[3]                    298.408             box origin
fShapeId                      256                 shape id
fShapeBits                    5134                shape bits
fName                         RICH_mirror_2_PartBoobject identifier
fTitle                                            object title
fUniqueID                     602                 object unique identifier
fBits                         0x03000000          bit field status word

Sphere center coordinates of the rotated mirror tile = {0.000000, 98.155617, 49.635877} and sphere inner radius = 300.000000
Reflective Plane Point coordinates = {-12.207585, 56.227287, 270.354767}
Mirror Point coordinates = {-15.521645, 72.396042, 348.124939}

Calculated and normalized normal of mirror tile = {0.051739, 0.085865, -0.994962}
Coordinates of point R2 on reflective plane after reflection on the mirror tile:
* using mirror point M to define Δ: {-10.954697, 101.644040, 274.339379}
* using sphere center C to define Δ: {-10.954697, 101.644040, 274.339379}

Coordinates of point P on PMT plane, after reflection on the mirror tile and extrapolation to the PMT plane:
* using mirror point M to define 𝒟 ': {-6.987430, 127.051522, 210.242505}
* using reflected point R2 to define 𝒟 ': {-6.987430, 127.051522, 210.242505}
Check whether extrapolated track point on PMT plane verifies its equation (value should be 0.):
* using mirror point M, checkCalc = 0.000000
* using reflected point R2, checkCalc = -0.000000
New coordinates of point P on PMT plane, after PMT plane rotation = {-6.680079, 143.140313, 199.435597}

Ring center coordinates = {-6.437081, 143.149551, 211.557778}
Difference in X = 0.242997	Difference in Y = 0.009238	Difference in Z = 12.122181
Distance between fitted ring center and extrapolated track hit = 12.124620
Distance between fitted ring center and extrapolated track hit in plane = 0.243173

End of loop on global tracks;
----------------------------------- End of loop N°1 on the mirror points. -----------------------------------

Top node path: cave_1 and mirror path: RICH_mirror_2_16
Mirror matrix parameters: 
matrix c1115 - tr=1  rot=1  refl=0  scl=0
  1.000000    0.000000    0.000000    Tx =   0.000000
  0.000000    1.000000    0.000000    Ty =  -0.000000
  0.000000    0.000000    1.000000    Tz =  -0.000000
Shape of the mirror tile:
==> Dumping object at: 0x00000000024b0e00, name=RICH_mirror_2_PartBody, class=TGeoSphere

fNz                           80                  number of z planes for drawing
fNseg                         80                  number of segments for drawing
fRmin                         300                 inner radius
fRmax                         300.6               outer radius
fTheta1                       90.038              lower theta limit
fTheta2                       98.156              higher theta limit
fPhi1                         355.93              lower phi limit
fPhi2                         364.07              higher phi limit
fDX                           2.19161             X half-length
fDY                           21.3351             Y half-length
fDZ                           21.2234             Z half-length
fOrigin[3]                    298.408             box origin
fShapeId                      256                 shape id
fShapeBits                    5134                shape bits
fName                         RICH_mirror_2_PartBoobject identifier
fTitle                                            object title
fUniqueID                     602                 object unique identifier
fBits                         0x03000000          bit field status word

Sphere center coordinates of the rotated mirror tile = {0.000000, 98.155617, 49.635877} and sphere inner radius = 300.000000
Reflective Plane Point coordinates = {-11.797795, 56.180637, 270.354767}
Mirror Point coordinates = {-14.949461, 72.337898, 348.149139}

Calculated and normalized normal of mirror tile = {0.049831, 0.086059, -0.995043}
Coordinates of point R2 on reflective plane after reflection on the mirror tile:
* using mirror point M to define Δ: {-10.509268, 101.606298, 274.348056}
* using sphere center C to define Δ: {-10.509268, 101.606298, 274.348056}

Coordinates of point P on PMT plane, after reflection on the mirror tile and extrapolation to the PMT plane:
* using mirror point M to define 𝒟 ': {-6.654008, 127.019006, 210.269207}
* using reflected point R2 to define 𝒟 ': {-6.654008, 127.019006, 210.269207}
Check whether extrapolated track point on PMT plane verifies its equation (value should be 0.):
* using mirror point M, checkCalc = 0.000000
* using reflected point R2, checkCalc = 0.000000
New coordinates of point P on PMT plane, after PMT plane rotation = {-6.345598, 143.107704, 199.435697}

Ring center coordinates = {-6.437081, 143.149551, 211.557778}
Difference in X = 0.091484	Difference in Y = 0.041848	Difference in Z = 12.122082
Distance between fitted ring center and extrapolated track hit = 12.122499
Distance between fitted ring center and extrapolated track hit in plane = 0.100601

End of loop on global tracks;
----------------------------------- End of loop N°2 on the mirror points. -----------------------------------

Mirror track ID <= 1 !!!
----------------------------------- End of loop N°3 on the mirror points. -----------------------------------

[INFO   ] CbmMatchRecoToMC::Exec eventNo=1
FinishEvent
[INFO   ] + StsDigitize         : step       2, time 0.048817 s, points: 18, signals: 64 / 61, digis: 36
[INFO   ] + StsFindClusters     : Event      2, time 0.000080 s, digis: 36, clusters: 16
[INFO   ] + StsFindHits         : Event      2, time 0.000048 s, clusters: 16, hits: 8
-I- CbmLitFindGlobalTracks: Number of STS tracks: 1
-I- CbmLitFindGlobalTracks: Number of hits: 0
CbmLitFindGlobalTracks::Exec event: 2

-------------------------------------------------------
-I-             Primary Vertex Finder               -I-
Vertex coord. (0.003665,-0.001158,0.000431) cm, chi2/ndf = 0.261928, 1 tracks used
-------------------------------------------------------
-I- CbmRichHitProducer, event no 3
SetPhotoDetPar routine called for PMT type 4
Nof hits: 45
Fraction of double hits: 0.444444
Nof crosstalk hits: 0.000000
CbmRichProjectionProducer: event 3
CbmRichRingFinderHough. Number of found rings 1

//--------------------------------------------------------------------------------------------------------------//
//---------------------------------------- EXEC Function - Defining the entries ----------------------------------------//
//----------------------------------------------------------------------------------------------------------------------//
CbmRichPMTMapping : Event #3
Nb of rings in evt = 1, nb of mirror points = 4, nb of hits in evt = 45, nb of Monte-Carlo points = 496 and nb of Monte-Carlo tracks = 498

//----------------------------------------------------------------------------------------------------------//
//---------------------------------------- EXEC Function ---------------------------------------------------//
//------------------------------ Mapping for mirror - PMT relations ----------------------------------------//
//----------------------------------------------------------------------------------------------------------//

-I- CbmRichHitProducer::InitRootGeometry

-I- RICH geometry parameters
PMT position in (x,y,z) [cm]: 51.000000  135.196678  207.021121
Tilted PMT position in (x,y,z) [cm]: 32.762850  151.309540  199.421426
PMT size in x and y [cm]: 50.000000  30.000000
PMT was tilted around x by 4.500000 degrees
PMT was tilted around y by -5.000000 degrees
Refractive index for lowest photon energies: 1.000446, (n-1)*10000: 4.462420
Mirror center (x,y,z): 0.000000 98.155617 49.635877
Mirror radius: 300.000000
Mirror tilting angle: -1.557800 degrees

//------------------------------ CbmRichPMTMapping: Projection Producer ------------------------------//

Calculated normal vector to PMT plane = {-0.087155, -0.078161, 0.993124} and constante d = -199.475339

Top node path: cave_1 and mirror path: RICH_mirror_2_16
Mirror matrix parameters: 
matrix c1115 - tr=1  rot=1  refl=0  scl=0
  1.000000    0.000000    0.000000    Tx =   0.000000
  0.000000    1.000000    0.000000    Ty =  -0.000000
  0.000000    0.000000    1.000000    Tz =  -0.000000
Shape of the mirror tile:
==> Dumping object at: 0x00000000024b0e00, name=RICH_mirror_2_PartBody, class=TGeoSphere

fNz                           80                  number of z planes for drawing
fNseg                         80                  number of segments for drawing
fRmin                         300                 inner radius
fRmax                         300.6               outer radius
fTheta1                       90.038              lower theta limit
fTheta2                       98.156              higher theta limit
fPhi1                         355.93              lower phi limit
fPhi2                         364.07              higher phi limit
fDX                           2.19161             X half-length
fDY                           21.3351             Y half-length
fDZ                           21.2234             Z half-length
fOrigin[3]                    298.408             box origin
fShapeId                      256                 shape id
fShapeBits                    5134                shape bits
fName                         RICH_mirror_2_PartBoobject identifier
fTitle                                            object title
fUniqueID                     602                 object unique identifier
fBits                         0x03000000          bit field status word

Sphere center coordinates of the rotated mirror tile = {0.000000, 98.155617, 49.635877} and sphere inner radius = 300.000000
Reflective Plane Point coordinates = {-12.117022, 56.197525, 270.354767}
Mirror Point coordinates = {-15.400530, 72.357727, 348.127930}

Calculated and normalized normal of mirror tile = {0.051335, 0.085993, -0.994972}
Coordinates of point R2 on reflective plane after reflection on the mirror tile:
* using mirror point M to define Δ: {-10.864578, 101.616541, 274.344833}
* using sphere center C to define Δ: {-10.864578, 101.616541, 274.344833}

Coordinates of point P on PMT plane, after reflection on the mirror tile and extrapolation to the PMT plane:
* using mirror point M to define 𝒟 ': {-6.924030, 127.034748, 210.246747}
* using reflected point R2 to define 𝒟 ': {-6.924030, 127.034748, 210.246747}
Check whether extrapolated track point on PMT plane verifies its equation (value should be 0.):
* using mirror point M, checkCalc = 0.000000
* using reflected point R2, checkCalc = -0.000000
New coordinates of point P on PMT plane, after PMT plane rotation = {-6.616550, 143.123489, 199.435617}

Ring center coordinates = {-6.673514, 143.148300, 211.536904}
Difference in X = 0.056964	Difference in Y = 0.024811	Difference in Z = 12.101287
Distance between fitted ring center and extrapolated track hit = 12.101447
Distance between fitted ring center and extrapolated track hit in plane = 0.062133

End of loop on global tracks;
----------------------------------- End of loop N°1 on the mirror points. -----------------------------------

Mirror track ID <= 1 !!!
----------------------------------- End of loop N°2 on the mirror points. -----------------------------------

Mirror track ID <= 1 !!!
----------------------------------- End of loop N°3 on the mirror points. -----------------------------------

Top node path: cave_1 and mirror path: RICH_mirror_2_16
Mirror matrix parameters: 
matrix c1115 - tr=1  rot=1  refl=0  scl=0
  1.000000    0.000000    0.000000    Tx =   0.000000
  0.000000    1.000000    0.000000    Ty =  -0.000000
  0.000000    0.000000    1.000000    Tz =  -0.000000
Shape of the mirror tile:
==> Dumping object at: 0x00000000024b0e00, name=RICH_mirror_2_PartBody, class=TGeoSphere

fNz                           80                  number of z planes for drawing
fNseg                         80                  number of segments for drawing
fRmin                         300                 inner radius
fRmax                         300.6               outer radius
fTheta1                       90.038              lower theta limit
fTheta2                       98.156              higher theta limit
fPhi1                         355.93              lower phi limit
fPhi2                         364.07              higher phi limit
fDX                           2.19161             X half-length
fDY                           21.3351             Y half-length
fDZ                           21.2234             Z half-length
fOrigin[3]                    298.408             box origin
fShapeId                      256                 shape id
fShapeBits                    5134                shape bits
fName                         RICH_mirror_2_PartBoobject identifier
fTitle                                            object title
fUniqueID                     602                 object unique identifier
fBits                         0x03000000          bit field status word

Sphere center coordinates of the rotated mirror tile = {0.000000, 98.155617, 49.635877} and sphere inner radius = 300.000000
Reflective Plane Point coordinates = {-12.140860, 56.229275, 270.354767}
Mirror Point coordinates = {-15.436092, 72.399513, 348.129700}

Calculated and normalized normal of mirror tile = {0.051454, 0.085854, -0.994978}
Coordinates of point R2 on reflective plane after reflection on the mirror tile:
* using mirror point M to define Δ: {-10.893335, 101.647938, 274.338316}
* using sphere center C to define Δ: {-10.893335, 101.647938, 274.338316}

Coordinates of point P on PMT plane, after reflection on the mirror tile and extrapolation to the PMT plane:
* using mirror point M to define 𝒟 ': {-6.947675, 127.051967, 210.246027}
* using reflected point R2 to define 𝒟 ': {-6.947675, 127.051967, 210.246027}
Check whether extrapolated track point on PMT plane verifies its equation (value should be 0.):
* using mirror point M, checkCalc = 0.000000
* using reflected point R2, checkCalc = -0.000000
New coordinates of point P on PMT plane, after PMT plane rotation = {-6.640168, 143.140760, 199.435605}

Ring center coordinates = {-6.673514, 143.148300, 211.536904}
Difference in X = 0.033346	Difference in Y = 0.007540	Difference in Z = 12.101299
Distance between fitted ring center and extrapolated track hit = 12.101347
Distance between fitted ring center and extrapolated track hit in plane = 0.034188

End of loop on global tracks;
----------------------------------- End of loop N°4 on the mirror points. -----------------------------------

[INFO   ] CbmMatchRecoToMC::Exec eventNo=2
FinishEvent
[INFO   ] + StsDigitize         : step       3, time 0.048075 s, points: 18, signals: 64 / 61, digis: 36
[INFO   ] + StsFindClusters     : Event      3, time 0.000045 s, digis: 36, clusters: 16
[INFO   ] + StsFindHits         : Event      3, time 0.000025 s, clusters: 16, hits: 8
-I- CbmLitFindGlobalTracks: Number of STS tracks: 1
-I- CbmLitFindGlobalTracks: Number of hits: 0
CbmLitFindGlobalTracks::Exec event: 3

-------------------------------------------------------
-I-             Primary Vertex Finder               -I-
Vertex coord. (0.001774,0.008205,-0.001616) cm, chi2/ndf = 0.464949, 1 tracks used
-------------------------------------------------------
-I- CbmRichHitProducer, event no 4
SetPhotoDetPar routine called for PMT type 4
Nof hits: 34
Fraction of double hits: 0.647059
Nof crosstalk hits: 0.000000
CbmRichProjectionProducer: event 4
CbmRichRingFinderHough. Number of found rings 1

//--------------------------------------------------------------------------------------------------------------//
//---------------------------------------- EXEC Function - Defining the entries ----------------------------------------//
//----------------------------------------------------------------------------------------------------------------------//
CbmRichPMTMapping : Event #4
Nb of rings in evt = 1, nb of mirror points = 3, nb of hits in evt = 34, nb of Monte-Carlo points = 491 and nb of Monte-Carlo tracks = 493

//----------------------------------------------------------------------------------------------------------//
//---------------------------------------- EXEC Function ---------------------------------------------------//
//------------------------------ Mapping for mirror - PMT relations ----------------------------------------//
//----------------------------------------------------------------------------------------------------------//

-I- CbmRichHitProducer::InitRootGeometry

-I- RICH geometry parameters
PMT position in (x,y,z) [cm]: 51.000000  135.196678  207.021121
Tilted PMT position in (x,y,z) [cm]: 32.762850  151.309540  199.421426
PMT size in x and y [cm]: 50.000000  30.000000
PMT was tilted around x by 4.500000 degrees
PMT was tilted around y by -5.000000 degrees
Refractive index for lowest photon energies: 1.000446, (n-1)*10000: 4.462420
Mirror center (x,y,z): 0.000000 98.155617 49.635877
Mirror radius: 300.000000
Mirror tilting angle: -1.557800 degrees

//------------------------------ CbmRichPMTMapping: Projection Producer ------------------------------//

Calculated normal vector to PMT plane = {0.087156, 0.078162, -0.993124} and constante d = 199.475196

Top node path: cave_1 and mirror path: RICH_mirror_2_16
Mirror matrix parameters: 
matrix c1115 - tr=1  rot=1  refl=0  scl=0
  1.000000    0.000000    0.000000    Tx =   0.000000
  0.000000    1.000000    0.000000    Ty =  -0.000000
  0.000000    0.000000    1.000000    Tz =  -0.000000
Shape of the mirror tile:
==> Dumping object at: 0x00000000024b0e00, name=RICH_mirror_2_PartBody, class=TGeoSphere

fNz                           80                  number of z planes for drawing
fNseg                         80                  number of segments for drawing
fRmin                         300                 inner radius
fRmax                         300.6               outer radius
fTheta1                       90.038              lower theta limit
fTheta2                       98.156              higher theta limit
fPhi1                         355.93              lower phi limit
fPhi2                         364.07              higher phi limit
fDX                           2.19161             X half-length
fDY                           21.3351             Y half-length
fDZ                           21.2234             Z half-length
fOrigin[3]                    298.408             box origin
fShapeId                      256                 shape id
fShapeBits                    5134                shape bits
fName                         RICH_mirror_2_PartBoobject identifier
fTitle                                            object title
fUniqueID                     602                 object unique identifier
fBits                         0x03000000          bit field status word

Sphere center coordinates of the rotated mirror tile = {0.000000, 98.155617, 49.635877} and sphere inner radius = 300.000000
Reflective Plane Point coordinates = {-12.169298, 56.241119, 270.354767}
Mirror Point coordinates = {-15.475110, 72.418053, 348.129272}

Calculated and normalized normal of mirror tile = {0.051584, 0.085792, -0.994977}
Coordinates of point R2 on reflective plane after reflection on the mirror tile:
* using mirror point M to define Δ: {-10.923030, 101.663907, 274.335954}
* using sphere center C to define Δ: {-10.923030, 101.663907, 274.335954}

Coordinates of point P on PMT plane, after reflection on the mirror tile and extrapolation to the PMT plane:
* using mirror point M to define 𝒟 ': {-6.969465, 127.064470, 210.245097}
* using reflected point R2 to define 𝒟 ': {-6.969465, 127.064470, 210.245097}
Check whether extrapolated track point on PMT plane verifies its equation (value should be 0.):
* using mirror point M, checkCalc = 0.000000
* using reflected point R2, checkCalc = 0.000000
New coordinates of point P on PMT plane, after PMT plane rotation = {-6.661956, 143.153301, 199.435594}

Ring center coordinates = {-6.702021, 143.175262, 211.536537}
Difference in X = 0.040064	Difference in Y = 0.021961	Difference in Z = 12.100943
Distance between fitted ring center and extrapolated track hit = 12.101029
Distance between fitted ring center and extrapolated track hit in plane = 0.045689

End of loop on global tracks;
----------------------------------- End of loop N°1 on the mirror points. -----------------------------------

Mirror track ID <= 1 !!!
----------------------------------- End of loop N°2 on the mirror points. -----------------------------------

Top node path: cave_1 and mirror path: RICH_mirror_2_16
Mirror matrix parameters: 
matrix c1115 - tr=1  rot=1  refl=0  scl=0
  1.000000    0.000000    0.000000    Tx =   0.000000
  0.000000    1.000000    0.000000    Ty =  -0.000000
  0.000000    0.000000    1.000000    Tz =  -0.000000
Shape of the mirror tile:
==> Dumping object at: 0x00000000024b0e00, name=RICH_mirror_2_PartBody, class=TGeoSphere

fNz                           80                  number of z planes for drawing
fNseg                         80                  number of segments for drawing
fRmin                         300                 inner radius
fRmax                         300.6               outer radius
fTheta1                       90.038              lower theta limit
fTheta2                       98.156              higher theta limit
fPhi1                         355.93              lower phi limit
fPhi2                         364.07              higher phi limit
fDX                           2.19161             X half-length
fDY                           21.3351             Y half-length
fDZ                           21.2234             Z half-length
fOrigin[3]                    298.408             box origin
fShapeId                      256                 shape id
fShapeBits                    5134                shape bits
fName                         RICH_mirror_2_PartBoobject identifier
fTitle                                            object title
fUniqueID                     602                 object unique identifier
fBits                         0x03000000          bit field status word

Sphere center coordinates of the rotated mirror tile = {0.000000, 98.155617, 49.635877} and sphere inner radius = 300.000000
Reflective Plane Point coordinates = {-12.172209, 56.223904, 270.354767}
Mirror Point coordinates = {-15.477276, 72.388748, 348.126617}

Calculated and normalized normal of mirror tile = {0.051591, 0.085889, -0.994968}
Coordinates of point R2 on reflective plane after reflection on the mirror tile:
* using mirror point M to define Δ: {-10.923752, 101.636727, 274.339711}
* using sphere center C to define Δ: {-10.923752, 101.636727, 274.339711}

Coordinates of point P on PMT plane, after reflection on the mirror tile and extrapolation to the PMT plane:
* using mirror point M to define 𝒟 ': {-6.968261, 127.043447, 210.243548}
* using reflected point R2 to define 𝒟 ': {-6.968261, 127.043447, 210.243548}
Check whether extrapolated track point on PMT plane verifies its equation (value should be 0.):
* using mirror point M, checkCalc = 0.000000
* using reflected point R2, checkCalc = 0.000000
New coordinates of point P on PMT plane, after PMT plane rotation = {-6.660892, 143.132214, 199.435601}

Ring center coordinates = {-6.702021, 143.175262, 211.536537}
Difference in X = 0.041129	Difference in Y = 0.043049	Difference in Z = 12.100936
Distance between fitted ring center and extrapolated track hit = 12.101083
Distance between fitted ring center and extrapolated track hit in plane = 0.059538

End of loop on global tracks;
----------------------------------- End of loop N°3 on the mirror points. -----------------------------------

[INFO   ] CbmMatchRecoToMC::Exec eventNo=3
FinishEvent
[INFO   ] + StsDigitize         : step       4, time 0.048346 s, points: 18, signals: 63 / 58, digis: 46
[INFO   ] + StsFindClusters     : Event      4, time 0.000050 s, digis: 46, clusters: 28
[INFO   ] + StsFindHits         : Event      4, time 0.000030 s, clusters: 28, hits: 26
-I- CbmLitFindGlobalTracks: Number of STS tracks: 2
-I- CbmLitFindGlobalTracks: Number of hits: 0
CbmLitFindGlobalTracks::Exec event: 4

-------------------------------------------------------
-I-             Primary Vertex Finder               -I-
Vertex coord. (-0.625946,2.569349,12.303517) cm, chi2/ndf = 0.760249, 2 tracks used
-------------------------------------------------------
-I- CbmRichHitProducer, event no 5
SetPhotoDetPar routine called for PMT type 4
Nof hits: 39
Fraction of double hits: 0.641026
Nof crosstalk hits: 0.000000
CbmRichProjectionProducer: event 5
CbmRichRingFinderHough. Number of found rings 1

//--------------------------------------------------------------------------------------------------------------//
//---------------------------------------- EXEC Function - Defining the entries ----------------------------------------//
//----------------------------------------------------------------------------------------------------------------------//
CbmRichPMTMapping : Event #5
Nb of rings in evt = 1, nb of mirror points = 3, nb of hits in evt = 39, nb of Monte-Carlo points = 483 and nb of Monte-Carlo tracks = 485

//----------------------------------------------------------------------------------------------------------//
//---------------------------------------- EXEC Function ---------------------------------------------------//
//------------------------------ Mapping for mirror - PMT relations ----------------------------------------//
//----------------------------------------------------------------------------------------------------------//

-I- CbmRichHitProducer::InitRootGeometry

-I- RICH geometry parameters
PMT position in (x,y,z) [cm]: 51.000000  135.196678  207.021121
Tilted PMT position in (x,y,z) [cm]: 32.762850  151.309540  199.421426
PMT size in x and y [cm]: 50.000000  30.000000
PMT was tilted around x by 4.500000 degrees
PMT was tilted around y by -5.000000 degrees
Refractive index for lowest photon energies: 1.000446, (n-1)*10000: 4.462420
Mirror center (x,y,z): 0.000000 98.155617 49.635877
Mirror radius: 300.000000
Mirror tilting angle: -1.557800 degrees

//------------------------------ CbmRichPMTMapping: Projection Producer ------------------------------//

Calculated normal vector to PMT plane = {-0.087155, -0.078163, 0.993124} and constante d = -199.475054

Top node path: cave_1 and mirror path: RICH_mirror_2_16
Mirror matrix parameters: 
matrix c1115 - tr=1  rot=1  refl=0  scl=0
  1.000000    0.000000    0.000000    Tx =   0.000000
  0.000000    1.000000    0.000000    Ty =  -0.000000
  0.000000    0.000000    1.000000    Tz =  -0.000000
Shape of the mirror tile:
==> Dumping object at: 0x00000000024b0e00, name=RICH_mirror_2_PartBody, class=TGeoSphere

fNz                           80                  number of z planes for drawing
fNseg                         80                  number of segments for drawing
fRmin                         300                 inner radius
fRmax                         300.6               outer radius
fTheta1                       90.038              lower theta limit
fTheta2                       98.156              higher theta limit
fPhi1                         355.93              lower phi limit
fPhi2                         364.07              higher phi limit
fDX                           2.19161             X half-length
fDY                           21.3351             Y half-length
fDZ                           21.2234             Z half-length
fOrigin[3]                    298.408             box origin
fShapeId                      256                 shape id
fShapeBits                    5134                shape bits
fName                         RICH_mirror_2_PartBoobject identifier
fTitle                                            object title
fUniqueID                     602                 object unique identifier
fBits                         0x03000000          bit field status word

Sphere center coordinates of the rotated mirror tile = {0.000000, 98.155617, 49.635877} and sphere inner radius = 300.000000
Reflective Plane Point coordinates = {-12.205438, 56.246414, 270.354767}
Mirror Point coordinates = {-15.516914, 72.419014, 348.127167}

Calculated and normalized normal of mirror tile = {0.051723, 0.085789, -0.994970}
Coordinates of point R2 on reflective plane after reflection on the mirror tile:
* using mirror point M to define Δ: {-10.949423, 101.659797, 274.335706}
* using sphere center C to define Δ: {-10.949423, 101.659797, 274.335706}

Coordinates of point P on PMT plane, after reflection on the mirror tile and extrapolation to the PMT plane:
* using mirror point M to define 𝒟 ': {-6.982282, 127.057173, 210.243391}
* using reflected point R2 to define 𝒟 ': {-6.982282, 127.057173, 210.243391}
Check whether extrapolated track point on PMT plane verifies its equation (value should be 0.):
* using mirror point M, checkCalc = 0.000000
* using reflected point R2, checkCalc = 0.000000
New coordinates of point P on PMT plane, after PMT plane rotation = {-6.674873, 143.145981, 199.435586}

Ring center coordinates = {-6.676467, 143.166702, 211.538116}
Difference in X = 0.001595	Difference in Y = 0.020721	Difference in Z = 12.102530
Distance between fitted ring center and extrapolated track hit = 12.102548
Distance between fitted ring center and extrapolated track hit in plane = 0.020783

End of loop on global tracks;
----------------------------------- End of loop N°1 on the mirror points. -----------------------------------

Top node path: cave_1 and mirror path: RICH_mirror_2_16
Mirror matrix parameters: 
matrix c1115 - tr=1  rot=1  refl=0  scl=0
  1.000000    0.000000    0.000000    Tx =   0.000000
  0.000000    1.000000    0.000000    Ty =  -0.000000
  0.000000    0.000000    1.000000    Tz =  -0.000000
Shape of the mirror tile:
==> Dumping object at: 0x00000000024b0e00, name=RICH_mirror_2_PartBody, class=TGeoSphere

fNz                           80                  number of z planes for drawing
fNseg                         80                  number of segments for drawing
fRmin                         300                 inner radius
fRmax                         300.6               outer radius
fTheta1                       90.038              lower theta limit
fTheta2                       98.156              higher theta limit
fPhi1                         355.93              lower phi limit
fPhi2                         364.07              higher phi limit
fDX                           2.19161             X half-length
fDY                           21.3351             Y half-length
fDZ                           21.2234             Z half-length
fOrigin[3]                    298.408             box origin
fShapeId                      256                 shape id
fShapeBits                    5134                shape bits
fName                         RICH_mirror_2_PartBoobject identifier
fTitle                                            object title
fUniqueID                     602                 object unique identifier
fBits                         0x03000000          bit field status word

Sphere center coordinates of the rotated mirror tile = {0.000000, 98.155617, 49.635877} and sphere inner radius = 300.000000
Reflective Plane Point coordinates = {-12.051862, 56.235279, 270.354767}
Mirror Point coordinates = {-15.316541, 72.405937, 348.136414}

Calculated and normalized normal of mirror tile = {0.051055, 0.085832, -0.995001}
Coordinates of point R2 on reflective plane after reflection on the mirror tile:
* using mirror point M to define Δ: {-10.803336, 101.652525, 274.336678}
* using sphere center C to define Δ: {-10.803336, 101.652525, 274.336678}

Coordinates of point P on PMT plane, after reflection on the mirror tile and extrapolation to the PMT plane:
* using mirror point M to define 𝒟 ': {-6.884215, 127.049315, 210.251378}
* using reflected point R2 to define 𝒟 ': {-6.884215, 127.049315, 210.251378}
Check whether extrapolated track point on PMT plane verifies its equation (value should be 0.):
* using mirror point M, checkCalc = -0.000000
* using reflected point R2, checkCalc = -0.000000
New coordinates of point P on PMT plane, after PMT plane rotation = {-6.576483, 143.138100, 199.435614}

Ring center coordinates = {-6.676467, 143.166702, 211.538116}
Difference in X = 0.099984	Difference in Y = 0.028602	Difference in Z = 12.102501
Distance between fitted ring center and extrapolated track hit = 12.102948
Distance between fitted ring center and extrapolated track hit in plane = 0.103995

End of loop on global tracks;
----------------------------------- End of loop N°2 on the mirror points. -----------------------------------

Mirror track ID <= 1 !!!
----------------------------------- End of loop N°3 on the mirror points. -----------------------------------

[INFO   ] CbmMatchRecoToMC::Exec eventNo=4
FinishEvent
[INFO   ] + StsDigitize         : step       5, time 0.059883 s, points: 18, signals: 64 / 60, digis: 37
[INFO   ] + StsFindClusters     : Event      5, time 0.000090 s, digis: 37, clusters: 19
[INFO   ] + StsFindHits         : Event      5, time 0.000056 s, clusters: 19, hits: 12
-I- CbmLitFindGlobalTracks: Number of STS tracks: 1
-I- CbmLitFindGlobalTracks: Number of hits: 0
CbmLitFindGlobalTracks::Exec event: 5

-------------------------------------------------------
-I-             Primary Vertex Finder               -I-
Vertex coord. (-0.007380,0.025624,-0.005710) cm, chi2/ndf = 0.661260, 1 tracks used
-------------------------------------------------------
-I- CbmRichHitProducer, event no 6
SetPhotoDetPar routine called for PMT type 4
Nof hits: 36
Fraction of double hits: 0.583333
Nof crosstalk hits: 0.000000
CbmRichProjectionProducer: event 6
CbmRichRingFinderHough. Number of found rings 1

//--------------------------------------------------------------------------------------------------------------//
//---------------------------------------- EXEC Function - Defining the entries ----------------------------------------//
//----------------------------------------------------------------------------------------------------------------------//
CbmRichPMTMapping : Event #6
Nb of rings in evt = 1, nb of mirror points = 2, nb of hits in evt = 36, nb of Monte-Carlo points = 468 and nb of Monte-Carlo tracks = 470

//----------------------------------------------------------------------------------------------------------//
//---------------------------------------- EXEC Function ---------------------------------------------------//
//------------------------------ Mapping for mirror - PMT relations ----------------------------------------//
//----------------------------------------------------------------------------------------------------------//

-I- CbmRichHitProducer::InitRootGeometry

-I- RICH geometry parameters
PMT position in (x,y,z) [cm]: 51.000000  135.196678  207.021121
Tilted PMT position in (x,y,z) [cm]: 32.762850  151.309540  199.421426
PMT size in x and y [cm]: 50.000000  30.000000
PMT was tilted around x by 4.500000 degrees
PMT was tilted around y by -5.000000 degrees
Refractive index for lowest photon energies: 1.000446, (n-1)*10000: 4.462420
Mirror center (x,y,z): 0.000000 98.155617 49.635877
Mirror radius: 300.000000
Mirror tilting angle: -1.557800 degrees

//------------------------------ CbmRichPMTMapping: Projection Producer ------------------------------//

Calculated normal vector to PMT plane = {-0.087154, -0.078162, 0.993124} and constante d = -199.475180

Top node path: cave_1 and mirror path: RICH_mirror_2_16
Mirror matrix parameters: 
matrix c1115 - tr=1  rot=1  refl=0  scl=0
  1.000000    0.000000    0.000000    Tx =   0.000000
  0.000000    1.000000    0.000000    Ty =  -0.000000
  0.000000    0.000000    1.000000    Tz =  -0.000000
Shape of the mirror tile:
==> Dumping object at: 0x00000000024b0e00, name=RICH_mirror_2_PartBody, class=TGeoSphere

fNz                           80                  number of z planes for drawing
fNseg                         80                  number of segments for drawing
fRmin                         300                 inner radius
fRmax                         300.6               outer radius
fTheta1                       90.038              lower theta limit
fTheta2                       98.156              higher theta limit
fPhi1                         355.93              lower phi limit
fPhi2                         364.07              higher phi limit
fDX                           2.19161             X half-length
fDY                           21.3351             Y half-length
fDZ                           21.2234             Z half-length
fOrigin[3]                    298.408             box origin
fShapeId                      256                 shape id
fShapeBits                    5134                shape bits
fName                         RICH_mirror_2_PartBoobject identifier
fTitle                                            object title
fUniqueID                     602                 object unique identifier
fBits                         0x03000000          bit field status word

Sphere center coordinates of the rotated mirror tile = {0.000000, 98.155617, 49.635877} and sphere inner radius = 300.000000
Reflective Plane Point coordinates = {-12.174281, 56.183418, 270.354767}
Mirror Point coordinates = {-15.478891, 72.338463, 348.122192}

Calculated and normalized normal of mirror tile = {0.051596, 0.086057, -0.994953}
Coordinates of point R2 on reflective plane after reflection on the mirror tile:
* using mirror point M to define Δ: {-10.924856, 101.600897, 274.347880}
* using sphere center C to define Δ: {-10.924856, 101.600897, 274.347880}

Coordinates of point P on PMT plane, after reflection on the mirror tile and extrapolation to the PMT plane:
* using mirror point M to define 𝒟 ': {-6.967670, 127.028213, 210.242388}
* using reflected point R2 to define 𝒟 ': {-6.967670, 127.028213, 210.242388}
Check whether extrapolated track point on PMT plane verifies its equation (value should be 0.):
* using mirror point M, checkCalc = 0.000000
* using reflected point R2, checkCalc = 0.000000
New coordinates of point P on PMT plane, after PMT plane rotation = {-6.660404, 143.116931, 199.435593}

Ring center coordinates = {-6.638244, 143.224457, 211.545996}
Difference in X = 0.022161	Difference in Y = 0.107525	Difference in Z = 12.110403
Distance between fitted ring center and extrapolated track hit = 12.110901
Distance between fitted ring center and extrapolated track hit in plane = 0.109785

End of loop on global tracks;
----------------------------------- End of loop N°1 on the mirror points. -----------------------------------

Top node path: cave_1 and mirror path: RICH_mirror_2_16
Mirror matrix parameters: 
matrix c1115 - tr=1  rot=1  refl=0  scl=0
  1.000000    0.000000    0.000000    Tx =   0.000000
  0.000000    1.000000    0.000000    Ty =  -0.000000
  0.000000    0.000000    1.000000    Tz =  -0.000000
Shape of the mirror tile:
==> Dumping object at: 0x00000000024b0e00, name=RICH_mirror_2_PartBody, class=TGeoSphere

fNz                           80                  number of z planes for drawing
fNseg                         80                  number of segments for drawing
fRmin                         300                 inner radius
fRmax                         300.6               outer radius
fTheta1                       90.038              lower theta limit
fTheta2                       98.156              higher theta limit
fPhi1                         355.93              lower phi limit
fPhi2                         364.07              higher phi limit
fDX                           2.19161             X half-length
fDY                           21.3351             Y half-length
fDZ                           21.2234             Z half-length
fOrigin[3]                    298.408             box origin
fShapeId                      256                 shape id
fShapeBits                    5134                shape bits
fName                         RICH_mirror_2_PartBoobject identifier
fTitle                                            object title
fUniqueID                     602                 object unique identifier
fBits                         0x03000000          bit field status word

Sphere center coordinates of the rotated mirror tile = {0.000000, 98.155617, 49.635877} and sphere inner radius = 300.000000
Reflective Plane Point coordinates = {-12.077200, 56.281319, 270.354767}
Mirror Point coordinates = {-15.344635, 72.470169, 348.140503}

Calculated and normalized normal of mirror tile = {0.051149, 0.085618, -0.995014}
Coordinates of point R2 on reflective plane after reflection on the mirror tile:
* using mirror point M to define Δ: {-10.819155, 101.703613, 274.327892}
* using sphere center C to define Δ: {-10.819155, 101.703613, 274.327892}

Coordinates of point P on PMT plane, after reflection on the mirror tile and extrapolation to the PMT plane:
* using mirror point M to define 𝒟 ': {-6.890713, 127.080341, 210.253244}
* using reflected point R2 to define 𝒟 ': {-6.890713, 127.080341, 210.253244}
Check whether extrapolated track point on PMT plane verifies its equation (value should be 0.):
* using mirror point M, checkCalc = 0.000000
* using reflected point R2, checkCalc = 0.000000
New coordinates of point P on PMT plane, after PMT plane rotation = {-6.582793, 143.169221, 199.435598}

Ring center coordinates = {-6.638244, 143.224457, 211.545996}
Difference in X = 0.055450	Difference in Y = 0.055235	Difference in Z = 12.110398
Distance between fitted ring center and extrapolated track hit = 12.110651
Distance between fitted ring center and extrapolated track hit in plane = 0.078267

End of loop on global tracks;
----------------------------------- End of loop N°2 on the mirror points. -----------------------------------

[INFO   ] CbmMatchRecoToMC::Exec eventNo=5
FinishEvent
[INFO   ] + StsDigitize         : step       6, time 0.048025 s, points: 20, signals: 71 / 69, digis: 46
[INFO   ] + StsFindClusters     : Event      6, time 0.000054 s, digis: 46, clusters: 31
[INFO   ] + StsFindHits         : Event      6, time 0.000035 s, clusters: 31, hits: 36
-I- CbmLitFindGlobalTracks: Number of STS tracks: 2
-I- CbmLitFindGlobalTracks: Number of hits: 0
CbmLitFindGlobalTracks::Exec event: 6

-------------------------------------------------------
-I-             Primary Vertex Finder               -I-
Vertex coord. (-0.025393,0.101274,0.390984) cm, chi2/ndf = 1.003527, 2 tracks used
-------------------------------------------------------
-I- CbmRichHitProducer, event no 7
SetPhotoDetPar routine called for PMT type 4
Nof hits: 98
Fraction of double hits: 0.387755
Nof crosstalk hits: 0.000000
CbmRichProjectionProducer: event 7
CbmRichRingFinderHough. Number of found rings 3

//--------------------------------------------------------------------------------------------------------------//
//---------------------------------------- EXEC Function - Defining the entries ----------------------------------------//
//----------------------------------------------------------------------------------------------------------------------//
CbmRichPMTMapping : Event #7
Nb of rings in evt = 3, nb of mirror points = 5, nb of hits in evt = 98, nb of Monte-Carlo points = 1080 and nb of Monte-Carlo tracks = 1085

//----------------------------------------------------------------------------------------------------------//
//---------------------------------------- EXEC Function ---------------------------------------------------//
//------------------------------ Mapping for mirror - PMT relations ----------------------------------------//
//----------------------------------------------------------------------------------------------------------//

-I- CbmRichHitProducer::InitRootGeometry

-I- RICH geometry parameters
PMT position in (x,y,z) [cm]: 51.000000  135.196678  207.021121
Tilted PMT position in (x,y,z) [cm]: 32.762850  151.309540  199.421426
PMT size in x and y [cm]: 50.000000  30.000000
PMT was tilted around x by 4.500000 degrees
PMT was tilted around y by -5.000000 degrees
Refractive index for lowest photon energies: 1.000446, (n-1)*10000: 4.462420
Mirror center (x,y,z): 0.000000 98.155617 49.635877
Mirror radius: 300.000000
Mirror tilting angle: -1.557800 degrees

//------------------------------ CbmRichPMTMapping: Projection Producer ------------------------------//

Calculated normal vector to PMT plane = {-0.087158, -0.078162, 0.993124} and constante d = -199.475240

Top node path: cave_1 and mirror path: RICH_mirror_2_16
Mirror matrix parameters: 
matrix c1115 - tr=1  rot=1  refl=0  scl=0
  1.000000    0.000000    0.000000    Tx =   0.000000
  0.000000    1.000000    0.000000    Ty =  -0.000000
  0.000000    0.000000    1.000000    Tz =  -0.000000
Shape of the mirror tile:
==> Dumping object at: 0x00000000024b0e00, name=RICH_mirror_2_PartBody, class=TGeoSphere

fNz                           80                  number of z planes for drawing
fNseg                         80                  number of segments for drawing
fRmin                         300                 inner radius
fRmax                         300.6               outer radius
fTheta1                       90.038              lower theta limit
fTheta2                       98.156              higher theta limit
fPhi1                         355.93              lower phi limit
fPhi2                         364.07              higher phi limit
fDX                           2.19161             X half-length
fDY                           21.3351             Y half-length
fDZ                           21.2234             Z half-length
fOrigin[3]                    298.408             box origin
fShapeId                      256                 shape id
fShapeBits                    5134                shape bits
fName                         RICH_mirror_2_PartBoobject identifier
fTitle                                            object title
fUniqueID                     602                 object unique identifier
fBits                         0x03000000          bit field status word

Sphere center coordinates of the rotated mirror tile = {0.000000, 98.155617, 49.635877} and sphere inner radius = 300.000000
Reflective Plane Point coordinates = {-11.702918, 56.192787, 270.354797}
Mirror Point coordinates = {-14.817636, 72.353867, 348.157074}

Calculated and normalized normal of mirror tile = {0.049392, 0.086006, -0.995070}
Coordinates of point R2 on reflective plane after reflection on the mirror tile:
* using mirror point M to define Δ: {-10.406725, 101.619223, 274.345429}
* using sphere center C to define Δ: {-10.406725, 101.619223, 274.345429}

Coordinates of point P on PMT plane, after reflection on the mirror tile and extrapolation to the PMT plane:
* using mirror point M to define 𝒟 ': {-6.578006, 127.021875, 210.276108}
* using reflected point R2 to define 𝒟 ': {-6.578006, 127.021875, 210.276108}
Check whether extrapolated track point on PMT plane verifies its equation (value should be 0.):
* using mirror point M, checkCalc = -0.000000
* using reflected point R2, checkCalc = 0.000000
New coordinates of point P on PMT plane, after PMT plane rotation = {-6.269284, 143.110584, 199.435722}

Ring center coordinates = {28.354776, 140.846573, 214.429888}
Difference in X = 34.624060	Difference in Y = 2.264011	Difference in Z = 14.994166
Distance between fitted ring center and extrapolated track hit = 37.799157
Distance between fitted ring center and extrapolated track hit in plane = 34.698001

Ring center coordinates = {-17.205080, 143.239502, 210.619838}
Difference in X = 10.935796	Difference in Y = 0.128918	Difference in Z = 11.184116
Distance between fitted ring center and extrapolated track hit = 15.642657
Distance between fitted ring center and extrapolated track hit in plane = 10.936556

End of loop on global tracks;
----------------------------------- End of loop N°1 on the mirror points. -----------------------------------

Top node path: cave_1 and mirror path: RICH_mirror_2_16
Mirror matrix parameters: 
matrix c1115 - tr=1  rot=1  refl=0  scl=0
  1.000000    0.000000    0.000000    Tx =   0.000000
  0.000000    1.000000    0.000000    Ty =  -0.000000
  0.000000    0.000000    1.000000    Tz =  -0.000000
Shape of the mirror tile:
==> Dumping object at: 0x00000000024b0e00, name=RICH_mirror_2_PartBody, class=TGeoSphere

fNz                           80                  number of z planes for drawing
fNseg                         80                  number of segments for drawing
fRmin                         300                 inner radius
fRmax                         300.6               outer radius
fTheta1                       90.038              lower theta limit
fTheta2                       98.156              higher theta limit
fPhi1                         355.93              lower phi limit
fPhi2                         364.07              higher phi limit
fDX                           2.19161             X half-length
fDY                           21.3351             Y half-length
fDZ                           21.2234             Z half-length
fOrigin[3]                    298.408             box origin
fShapeId                      256                 shape id
fShapeBits                    5134                shape bits
fName                         RICH_mirror_2_PartBoobject identifier
fTitle                                            object title
fUniqueID                     602                 object unique identifier
fBits                         0x03000000          bit field status word

Sphere center coordinates of the rotated mirror tile = {0.000000, 98.155617, 49.635877} and sphere inner radius = 300.000000
Reflective Plane Point coordinates = {-12.065771, 56.258095, 270.354767}
Mirror Point coordinates = {-15.321324, 72.435387, 348.138702}

Calculated and normalized normal of mirror tile = {0.051071, 0.085734, -0.995008}
Coordinates of point R2 on reflective plane after reflection on the mirror tile:
* using mirror point M to define Δ: {-10.796210, 101.674250, 274.333172}
* using sphere center C to define Δ: {-10.796210, 101.674250, 274.333172}

Coordinates of point P on PMT plane, after reflection on the mirror tile and extrapolation to the PMT plane:
* using mirror point M to define 𝒟 ': {-6.867413, 127.060025, 210.253712}
* using reflected point R2 to define 𝒟 ': {-6.867413, 127.060025, 210.253712}
Check whether extrapolated track point on PMT plane verifies its equation (value should be 0.):
* using mirror point M, checkCalc = -0.000000
* using reflected point R2, checkCalc = -0.000000
New coordinates of point P on PMT plane, after PMT plane rotation = {-6.559542, 143.148845, 199.435632}

Ring center coordinates = {28.354776, 140.846573, 214.429888}
Difference in X = 34.914318	Difference in Y = 2.302272	Difference in Z = 14.994256
Distance between fitted ring center and extrapolated track hit = 38.067542
Distance between fitted ring center and extrapolated track hit in plane = 34.990142

Ring center coordinates = {-17.205080, 143.239502, 210.619838}
Difference in X = 10.645538	Difference in Y = 0.090657	Difference in Z = 11.184206
Distance between fitted ring center and extrapolated track hit = 15.440925
Distance between fitted ring center and extrapolated track hit in plane = 10.645924

End of loop on global tracks;
----------------------------------- End of loop N°2 on the mirror points. -----------------------------------

Not a mother particle ...
----------------------------------- End of loop N°3 on the mirror points. -----------------------------------

Mirror track ID <= 1 !!!
----------------------------------- End of loop N°4 on the mirror points. -----------------------------------

Not a mother particle ...
----------------------------------- End of loop N°5 on the mirror points. -----------------------------------

[INFO   ] CbmMatchRecoToMC::Exec eventNo=6
FinishEvent
[INFO   ] + StsDigitize         : step       7, time 0.046070 s, points: 18, signals: 64 / 60, digis: 38
[INFO   ] + StsFindClusters     : Event      7, time 0.000050 s, digis: 38, clusters: 24
[INFO   ] + StsFindHits         : Event      7, time 0.000029 s, clusters: 24, hits: 20
-I- CbmLitFindGlobalTracks: Number of STS tracks: 2
-I- CbmLitFindGlobalTracks: Number of hits: 0
CbmLitFindGlobalTracks::Exec event: 7

-------------------------------------------------------
-I-             Primary Vertex Finder               -I-
Vertex coord. (-1.106852,4.504887,21.580533) cm, chi2/ndf = 0.683516, 2 tracks used
-------------------------------------------------------
-I- CbmRichHitProducer, event no 8
SetPhotoDetPar routine called for PMT type 4
Nof hits: 57
Fraction of double hits: 0.315789
Nof crosstalk hits: 0.000000
CbmRichProjectionProducer: event 8
CbmRichRingFinderHough. Number of found rings 2

//--------------------------------------------------------------------------------------------------------------//
//---------------------------------------- EXEC Function - Defining the entries ----------------------------------------//
//----------------------------------------------------------------------------------------------------------------------//
CbmRichPMTMapping : Event #8
Nb of rings in evt = 2, nb of mirror points = 5, nb of hits in evt = 57, nb of Monte-Carlo points = 669 and nb of Monte-Carlo tracks = 673

//----------------------------------------------------------------------------------------------------------//
//---------------------------------------- EXEC Function ---------------------------------------------------//
//------------------------------ Mapping for mirror - PMT relations ----------------------------------------//
//----------------------------------------------------------------------------------------------------------//

-I- CbmRichHitProducer::InitRootGeometry

-I- RICH geometry parameters
PMT position in (x,y,z) [cm]: 51.000000  135.196678  207.021121
Tilted PMT position in (x,y,z) [cm]: 32.762850  151.309540  199.421426
PMT size in x and y [cm]: 50.000000  30.000000
PMT was tilted around x by 4.500000 degrees
PMT was tilted around y by -5.000000 degrees
Refractive index for lowest photon energies: 1.000446, (n-1)*10000: 4.462420
Mirror center (x,y,z): 0.000000 98.155617 49.635877
Mirror radius: 300.000000
Mirror tilting angle: -1.557800 degrees

//------------------------------ CbmRichPMTMapping: Projection Producer ------------------------------//

Calculated normal vector to PMT plane = {0.087157, 0.078161, -0.993124} and constante d = 199.475354

Top node path: cave_1 and mirror path: RICH_mirror_2_16
Mirror matrix parameters: 
matrix c1115 - tr=1  rot=1  refl=0  scl=0
  1.000000    0.000000    0.000000    Tx =   0.000000
  0.000000    1.000000    0.000000    Ty =  -0.000000
  0.000000    0.000000    1.000000    Tz =  -0.000000
Shape of the mirror tile:
==> Dumping object at: 0x00000000024b0e00, name=RICH_mirror_2_PartBody, class=TGeoSphere

fNz                           80                  number of z planes for drawing
fNseg                         80                  number of segments for drawing
fRmin                         300                 inner radius
fRmax                         300.6               outer radius
fTheta1                       90.038              lower theta limit
fTheta2                       98.156              higher theta limit
fPhi1                         355.93              lower phi limit
fPhi2                         364.07              higher phi limit
fDX                           2.19161             X half-length
fDY                           21.3351             Y half-length
fDZ                           21.2234             Z half-length
fOrigin[3]                    298.408             box origin
fShapeId                      256                 shape id
fShapeBits                    5134                shape bits
fName                         RICH_mirror_2_PartBoobject identifier
fTitle                                            object title
fUniqueID                     602                 object unique identifier
fBits                         0x03000000          bit field status word

Sphere center coordinates of the rotated mirror tile = {0.000000, 98.155617, 49.635877} and sphere inner radius = 300.000000
Reflective Plane Point coordinates = {-10.796499, 56.361900, 270.354797}
Mirror Point coordinates = {-13.475253, 72.596275, 348.241547}

Calculated and normalized normal of mirror tile = {0.044917, 0.085198, -0.995351}
Coordinates of point R2 on reflective plane after reflection on the mirror tile:
* using mirror point M to define Δ: {-9.303030, 101.825320, 274.313664}
* using sphere center C to define Δ: {-9.303030, 101.825320, 274.313664}

Coordinates of point P on PMT plane, after reflection on the mirror tile and extrapolation to the PMT plane:
* using mirror point M to define 𝒟 ': {-5.693754, 127.110563, 210.360685}
* using reflected point R2 to define 𝒟 ': {-5.693754, 127.110563, 210.360685}
Check whether extrapolated track point on PMT plane verifies its equation (value should be 0.):
* using mirror point M, checkCalc = 0.000000
* using reflected point R2, checkCalc = 0.000000
New coordinates of point P on PMT plane, after PMT plane rotation = {-5.381026, 143.199562, 199.435928}

Ring center coordinates = {-6.691482, 143.132828, 211.534108}
Difference in X = 1.310456	Difference in Y = 0.066735	Difference in Z = 12.098180
Distance between fitted ring center and extrapolated track hit = 12.169129
Distance between fitted ring center and extrapolated track hit in plane = 1.312155

Ring center coordinates = {-7.019119, 141.701248, 211.392686}
Difference in X = 1.638094	Difference in Y = 1.498314	Difference in Z = 11.956758
Distance between fitted ring center and extrapolated track hit = 12.161100
Distance between fitted ring center and extrapolated track hit in plane = 2.219977

End of loop on global tracks;
----------------------------------- End of loop N°1 on the mirror points. -----------------------------------

Not a mother particle ...
----------------------------------- End of loop N°2 on the mirror points. -----------------------------------

Mirror track ID <= 1 !!!
----------------------------------- End of loop N°3 on the mirror points. -----------------------------------

Mirror track ID <= 1 !!!
----------------------------------- End of loop N°4 on the mirror points. -----------------------------------

Top node path: cave_1 and mirror path: RICH_mirror_2_16
Mirror matrix parameters: 
matrix c1115 - tr=1  rot=1  refl=0  scl=0
  1.000000    0.000000    0.000000    Tx =   0.000000
  0.000000    1.000000    0.000000    Ty =  -0.000000
  0.000000    0.000000    1.000000    Tz =  -0.000000
Shape of the mirror tile:
==> Dumping object at: 0x00000000024b0e00, name=RICH_mirror_2_PartBody, class=TGeoSphere

fNz                           80                  number of z planes for drawing
fNseg                         80                  number of segments for drawing
fRmin                         300                 inner radius
fRmax                         300.6               outer radius
fTheta1                       90.038              lower theta limit
fTheta2                       98.156              higher theta limit
fPhi1                         355.93              lower phi limit
fPhi2                         364.07              higher phi limit
fDX                           2.19161             X half-length
fDY                           21.3351             Y half-length
fDZ                           21.2234             Z half-length
fOrigin[3]                    298.408             box origin
fShapeId                      256                 shape id
fShapeBits                    5134                shape bits
fName                         RICH_mirror_2_PartBoobject identifier
fTitle                                            object title
fUniqueID                     602                 object unique identifier
fBits                         0x03000000          bit field status word

Sphere center coordinates of the rotated mirror tile = {0.000000, 98.155617, 49.635877} and sphere inner radius = 300.000000
Reflective Plane Point coordinates = {-12.182383, 56.202778, 270.354767}
Mirror Point coordinates = {-15.489927, 72.365501, 348.123962}

Calculated and normalized normal of mirror tile = {0.051633, 0.085967, -0.994959}
Coordinates of point R2 on reflective plane after reflection on the mirror tile:
* using mirror point M to define Δ: {-10.932884, 101.622452, 274.343982}
* using sphere center C to define Δ: {-10.932884, 101.622452, 274.343982}

Coordinates of point P on PMT plane, after reflection on the mirror tile and extrapolation to the PMT plane:
* using mirror point M to define 𝒟 ': {-6.973662, 127.041298, 210.242908}
* using reflected point R2 to define 𝒟 ': {-6.973662, 127.041298, 210.242908}
Check whether extrapolated track point on PMT plane verifies its equation (value should be 0.):
* using mirror point M, checkCalc = 0.000000
* using reflected point R2, checkCalc = -0.000000
New coordinates of point P on PMT plane, after PMT plane rotation = {-6.666328, 143.130058, 199.435603}

Ring center coordinates = {-6.691482, 143.132828, 211.534108}
Difference in X = 0.025154	Difference in Y = 0.002770	Difference in Z = 12.098504
Distance between fitted ring center and extrapolated track hit = 12.098531
Distance between fitted ring center and extrapolated track hit in plane = 0.025306

Ring center coordinates = {-7.019119, 141.701248, 211.392686}
Difference in X = 0.352791	Difference in Y = 1.428810	Difference in Z = 11.957083
Distance between fitted ring center and extrapolated track hit = 12.047314
Distance between fitted ring center and extrapolated track hit in plane = 1.471720

End of loop on global tracks;
----------------------------------- End of loop N°5 on the mirror points. -----------------------------------

[INFO   ] CbmMatchRecoToMC::Exec eventNo=7
FinishEvent
[INFO   ] + StsDigitize         : step       8, time 0.047683 s, points: 18, signals: 64 / 58, digis: 39
[INFO   ] + StsFindClusters     : Event      8, time 0.000048 s, digis: 39, clusters: 18
[INFO   ] + StsFindHits         : Event      8, time 0.000027 s, clusters: 18, hits: 10
-I- CbmLitFindGlobalTracks: Number of STS tracks: 1
-I- CbmLitFindGlobalTracks: Number of hits: 0
CbmLitFindGlobalTracks::Exec event: 8

-------------------------------------------------------
-I-             Primary Vertex Finder               -I-
Vertex coord. (0.011231,0.045289,-0.008847) cm, chi2/ndf = 8.896776, 1 tracks used
-------------------------------------------------------
-I- CbmRichHitProducer, event no 9
SetPhotoDetPar routine called for PMT type 4
Nof hits: 46
Fraction of double hits: 0.543478
Nof crosstalk hits: 0.000000
CbmRichProjectionProducer: event 9
CbmRichRingFinderHough. Number of found rings 1

//--------------------------------------------------------------------------------------------------------------//
//---------------------------------------- EXEC Function - Defining the entries ----------------------------------------//
//----------------------------------------------------------------------------------------------------------------------//
CbmRichPMTMapping : Event #9
Nb of rings in evt = 1, nb of mirror points = 2, nb of hits in evt = 46, nb of Monte-Carlo points = 508 and nb of Monte-Carlo tracks = 510

//----------------------------------------------------------------------------------------------------------//
//---------------------------------------- EXEC Function ---------------------------------------------------//
//------------------------------ Mapping for mirror - PMT relations ----------------------------------------//
//----------------------------------------------------------------------------------------------------------//

-I- CbmRichHitProducer::InitRootGeometry

-I- RICH geometry parameters
PMT position in (x,y,z) [cm]: 51.000000  135.196678  207.021121
Tilted PMT position in (x,y,z) [cm]: 32.762850  151.309540  199.421426
PMT size in x and y [cm]: 50.000000  30.000000
PMT was tilted around x by 4.500000 degrees
PMT was tilted around y by -5.000000 degrees
Refractive index for lowest photon energies: 1.000446, (n-1)*10000: 4.462420
Mirror center (x,y,z): 0.000000 98.155617 49.635877
Mirror radius: 300.000000
Mirror tilting angle: -1.557800 degrees

//------------------------------ CbmRichPMTMapping: Projection Producer ------------------------------//

Calculated normal vector to PMT plane = {-0.087158, -0.078162, 0.993124} and constante d = -199.475248

Top node path: cave_1 and mirror path: RICH_mirror_2_16
Mirror matrix parameters: 
matrix c1115 - tr=1  rot=1  refl=0  scl=0
  1.000000    0.000000    0.000000    Tx =   0.000000
  0.000000    1.000000    0.000000    Ty =  -0.000000
  0.000000    0.000000    1.000000    Tz =  -0.000000
Shape of the mirror tile:
==> Dumping object at: 0x00000000024b0e00, name=RICH_mirror_2_PartBody, class=TGeoSphere

fNz                           80                  number of z planes for drawing
fNseg                         80                  number of segments for drawing
fRmin                         300                 inner radius
fRmax                         300.6               outer radius
fTheta1                       90.038              lower theta limit
fTheta2                       98.156              higher theta limit
fPhi1                         355.93              lower phi limit
fPhi2                         364.07              higher phi limit
fDX                           2.19161             X half-length
fDY                           21.3351             Y half-length
fDZ                           21.2234             Z half-length
fOrigin[3]                    298.408             box origin
fShapeId                      256                 shape id
fShapeBits                    5134                shape bits
fName                         RICH_mirror_2_PartBoobject identifier
fTitle                                            object title
fUniqueID                     602                 object unique identifier
fBits                         0x03000000          bit field status word

Sphere center coordinates of the rotated mirror tile = {0.000000, 98.155617, 49.635877} and sphere inner radius = 300.000000
Reflective Plane Point coordinates = {-12.185925, 56.239250, 270.354767}
Mirror Point coordinates = {-15.496281, 72.417618, 348.128143}

Calculated and normalized normal of mirror tile = {0.051654, 0.085793, -0.994973}
Coordinates of point R2 on reflective plane after reflection on the mirror tile:
* using mirror point M to define Δ: {-10.938108, 101.664939, 274.336454}
* using sphere center C to define Δ: {-10.938108, 101.664939, 274.336454}

Coordinates of point P on PMT plane, after reflection on the mirror tile and extrapolation to the PMT plane:
* using mirror point M to define 𝒟 ': {-6.979097, 127.067764, 210.244520}
* using reflected point R2 to define 𝒟 ': {-6.979097, 127.067764, 210.244520}
Check whether extrapolated track point on PMT plane verifies its equation (value should be 0.):
* using mirror point M, checkCalc = 0.000000
* using reflected point R2, checkCalc = 0.000000
New coordinates of point P on PMT plane, after PMT plane rotation = {-6.671601, 143.156605, 199.435600}

Ring center coordinates = {-6.342639, 143.181290, 211.568554}
Difference in X = 0.328962	Difference in Y = 0.024684	Difference in Z = 12.132955
Distance between fitted ring center and extrapolated track hit = 12.137439
Distance between fitted ring center and extrapolated track hit in plane = 0.329887

End of loop on global tracks;
----------------------------------- End of loop N°1 on the mirror points. -----------------------------------

Top node path: cave_1 and mirror path: RICH_mirror_2_16
Mirror matrix parameters: 
matrix c1115 - tr=1  rot=1  refl=0  scl=0
  1.000000    0.000000    0.000000    Tx =   0.000000
  0.000000    1.000000    0.000000    Ty =  -0.000000
  0.000000    0.000000    1.000000    Tz =  -0.000000
Shape of the mirror tile:
==> Dumping object at: 0x00000000024b0e00, name=RICH_mirror_2_PartBody, class=TGeoSphere

fNz                           80                  number of z planes for drawing
fNseg                         80                  number of segments for drawing
fRmin                         300                 inner radius
fRmax                         300.6               outer radius
fTheta1                       90.038              lower theta limit
fTheta2                       98.156              higher theta limit
fPhi1                         355.93              lower phi limit
fPhi2                         364.07              higher phi limit
fDX                           2.19161             X half-length
fDY                           21.3351             Y half-length
fDZ                           21.2234             Z half-length
fOrigin[3]                    298.408             box origin
fShapeId                      256                 shape id
fShapeBits                    5134                shape bits
fName                         RICH_mirror_2_PartBoobject identifier
fTitle                                            object title
fUniqueID                     602                 object unique identifier
fBits                         0x03000000          bit field status word

Sphere center coordinates of the rotated mirror tile = {0.000000, 98.155617, 49.635877} and sphere inner radius = 300.000000
Reflective Plane Point coordinates = {-11.579024, 56.212540, 270.354797}
Mirror Point coordinates = {-14.575117, 72.384911, 348.171692}

Calculated and normalized normal of mirror tile = {0.048584, 0.085902, -0.995118}
Coordinates of point R2 on reflective plane after reflection on the mirror tile:
* using mirror point M to define Δ: {-10.167706, 101.647641, 274.345825}
* using sphere center C to define Δ: {-10.167706, 101.647641, 274.345825}

Coordinates of point P on PMT plane, after reflection on the mirror tile and extrapolation to the PMT plane:
* using mirror point M to define 𝒟 ': {-6.344025, 127.034736, 210.297655}
* using reflected point R2 to define 𝒟 ': {-6.344025, 127.034736, 210.297655}
Check whether extrapolated track point on PMT plane verifies its equation (value should be 0.):
* using mirror point M, checkCalc = -0.000000
* using reflected point R2, checkCalc = -0.000000
New coordinates of point P on PMT plane, after PMT plane rotation = {-6.034315, 143.123490, 199.435781}

Ring center coordinates = {-6.342639, 143.181290, 211.568554}
Difference in X = 0.308324	Difference in Y = 0.057800	Difference in Z = 12.132773
Distance between fitted ring center and extrapolated track hit = 12.136828
Distance between fitted ring center and extrapolated track hit in plane = 0.313695

End of loop on global tracks;
----------------------------------- End of loop N°2 on the mirror points. -----------------------------------

[INFO   ] CbmMatchRecoToMC::Exec eventNo=8
FinishEvent
[INFO   ] + StsDigitize         : step       9, time 0.049260 s, points: 18, signals: 63 / 60, digis: 37
[INFO   ] + StsFindClusters     : Event      9, time 0.000047 s, digis: 37, clusters: 16
[INFO   ] + StsFindHits         : Event      9, time 0.000025 s, clusters: 16, hits: 8
-I- CbmLitFindGlobalTracks: Number of STS tracks: 1
-I- CbmLitFindGlobalTracks: Number of hits: 0
CbmLitFindGlobalTracks::Exec event: 9

-------------------------------------------------------
-I-             Primary Vertex Finder               -I-
Vertex coord. (-0.010778,0.012807,-0.003223) cm, chi2/ndf = 2.614818, 1 tracks used
-------------------------------------------------------
-I- CbmRichHitProducer, event no 10
SetPhotoDetPar routine called for PMT type 4
Nof hits: 42
Fraction of double hits: 0.690476
Nof crosstalk hits: 0.000000
CbmRichProjectionProducer: event 10
CbmRichRingFinderHough. Number of found rings 1

//--------------------------------------------------------------------------------------------------------------//
//---------------------------------------- EXEC Function - Defining the entries ----------------------------------------//
//----------------------------------------------------------------------------------------------------------------------//
CbmRichPMTMapping : Event #10
Nb of rings in evt = 1, nb of mirror points = 3, nb of hits in evt = 42, nb of Monte-Carlo points = 529 and nb of Monte-Carlo tracks = 531

//----------------------------------------------------------------------------------------------------------//
//---------------------------------------- EXEC Function ---------------------------------------------------//
//------------------------------ Mapping for mirror - PMT relations ----------------------------------------//
//----------------------------------------------------------------------------------------------------------//

-I- CbmRichHitProducer::InitRootGeometry

-I- RICH geometry parameters
PMT position in (x,y,z) [cm]: 51.000000  135.196678  207.021121
Tilted PMT position in (x,y,z) [cm]: 32.762850  151.309540  199.421426
PMT size in x and y [cm]: 50.000000  30.000000
PMT was tilted around x by 4.500000 degrees
PMT was tilted around y by -5.000000 degrees
Refractive index for lowest photon energies: 1.000446, (n-1)*10000: 4.462420
Mirror center (x,y,z): 0.000000 98.155617 49.635877
Mirror radius: 300.000000
Mirror tilting angle: -1.557800 degrees

//------------------------------ CbmRichPMTMapping: Projection Producer ------------------------------//

Calculated normal vector to PMT plane = {-0.087155, -0.078162, 0.993124} and constante d = -199.475148

Top node path: cave_1 and mirror path: RICH_mirror_2_16
Mirror matrix parameters: 
matrix c1115 - tr=1  rot=1  refl=0  scl=0
  1.000000    0.000000    0.000000    Tx =   0.000000
  0.000000    1.000000    0.000000    Ty =  -0.000000
  0.000000    0.000000    1.000000    Tz =  -0.000000
Shape of the mirror tile:
==> Dumping object at: 0x00000000024b0e00, name=RICH_mirror_2_PartBody, class=TGeoSphere

fNz                           80                  number of z planes for drawing
fNseg                         80                  number of segments for drawing
fRmin                         300                 inner radius
fRmax                         300.6               outer radius
fTheta1                       90.038              lower theta limit
fTheta2                       98.156              higher theta limit
fPhi1                         355.93              lower phi limit
fPhi2                         364.07              higher phi limit
fDX                           2.19161             X half-length
fDY                           21.3351             Y half-length
fDZ                           21.2234             Z half-length
fOrigin[3]                    298.408             box origin
fShapeId                      256                 shape id
fShapeBits                    5134                shape bits
fName                         RICH_mirror_2_PartBoobject identifier
fTitle                                            object title
fUniqueID                     602                 object unique identifier
fBits                         0x03000000          bit field status word

Sphere center coordinates of the rotated mirror tile = {0.000000, 98.155617, 49.635877} and sphere inner radius = 300.000000
Reflective Plane Point coordinates = {-12.197017, 56.189148, 270.354767}
Mirror Point coordinates = {-15.508580, 72.349800, 348.121643}

Calculated and normalized normal of mirror tile = {0.051695, 0.086019, -0.994951}
Coordinates of point R2 on reflective plane after reflection on the mirror tile:
* using mirror point M to define Δ: {-10.946413, 101.612106, 274.346822}
* using sphere center C to define Δ: {-10.946413, 101.612106, 274.346822}

Coordinates of point P on PMT plane, after reflection on the mirror tile and extrapolation to the PMT plane:
* using mirror point M to define 𝒟 ': {-6.982227, 127.038884, 210.241965}
* using reflected point R2 to define 𝒟 ': {-6.982227, 127.038884, 210.241965}
Check whether extrapolated track point on PMT plane verifies its equation (value should be 0.):
* using mirror point M, checkCalc = 0.000000
* using reflected point R2, checkCalc = 0.000000
New coordinates of point P on PMT plane, after PMT plane rotation = {-6.674943, 143.127636, 199.435600}

Ring center coordinates = {-6.494244, 143.095963, 211.548539}
Difference in X = 0.180699	Difference in Y = 0.031674	Difference in Z = 12.112939
Distance between fitted ring center and extrapolated track hit = 12.114328
Distance between fitted ring center and extrapolated track hit in plane = 0.183454

End of loop on global tracks;
----------------------------------- End of loop N°1 on the mirror points. -----------------------------------

Mirror track ID <= 1 !!!
----------------------------------- End of loop N°2 on the mirror points. -----------------------------------

Top node path: cave_1 and mirror path: RICH_mirror_2_16
Mirror matrix parameters: 
matrix c1115 - tr=1  rot=1  refl=0  scl=0
  1.000000    0.000000    0.000000    Tx =   0.000000
  0.000000    1.000000    0.000000    Ty =  -0.000000
  0.000000    0.000000    1.000000    Tz =  -0.000000
Shape of the mirror tile:
==> Dumping object at: 0x00000000024b0e00, name=RICH_mirror_2_PartBody, class=TGeoSphere

fNz                           80                  number of z planes for drawing
fNseg                         80                  number of segments for drawing
fRmin                         300                 inner radius
fRmax                         300.6               outer radius
fTheta1                       90.038              lower theta limit
fTheta2                       98.156              higher theta limit
fPhi1                         355.93              lower phi limit
fPhi2                         364.07              higher phi limit
fDX                           2.19161             X half-length
fDY                           21.3351             Y half-length
fDZ                           21.2234             Z half-length
fOrigin[3]                    298.408             box origin
fShapeId                      256                 shape id
fShapeBits                    5134                shape bits
fName                         RICH_mirror_2_PartBoobject identifier
fTitle                                            object title
fUniqueID                     602                 object unique identifier
fBits                         0x03000000          bit field status word

Sphere center coordinates of the rotated mirror tile = {0.000000, 98.155617, 49.635877} and sphere inner radius = 300.000000
Reflective Plane Point coordinates = {-12.014225, 56.182774, 270.354797}
Mirror Point coordinates = {-15.238434, 72.339310, 348.134644}

Calculated and normalized normal of mirror tile = {0.050795, 0.086054, -0.994995}
Coordinates of point R2 on reflective plane after reflection on the mirror tile:
* using mirror point M to define Δ: {-10.725187, 101.604314, 274.348983}
* using sphere center C to define Δ: {-10.725187, 101.604314, 274.348983}

Coordinates of point P on PMT plane, after reflection on the mirror tile and extrapolation to the PMT plane:
* using mirror point M to define 𝒟 ': {-6.804838, 127.024822, 210.256425}
* using reflected point R2 to define 𝒟 ': {-6.804838, 127.024822, 210.256425}
Check whether extrapolated track point on PMT plane verifies its equation (value should be 0.):
* using mirror point M, checkCalc = 0.000000
* using reflected point R2, checkCalc = -0.000000
New coordinates of point P on PMT plane, after PMT plane rotation = {-6.496968, 143.113535, 199.435652}

Ring center coordinates = {-6.494244, 143.095963, 211.548539}
Difference in X = 0.002725	Difference in Y = 0.017572	Difference in Z = 12.112887
Distance between fitted ring center and extrapolated track hit = 12.112900
Distance between fitted ring center and extrapolated track hit in plane = 0.017782

End of loop on global tracks;
----------------------------------- End of loop N°3 on the mirror points. -----------------------------------

[INFO   ] CbmMatchRecoToMC::Exec eventNo=9
FinishEvent

[INFO   ] =====================================
[INFO   ] StsDigitize: Run summary
[INFO   ] Steps processed  : 10
[INFO   ] StsPoint / step  : 18.4
[INFO   ] Signals / step   : 68.0 / 64.3
[INFO   ] StsDigi / step   : 46.2
[INFO   ] Digis per point  : 2.510870
[INFO   ] Digis per signal : 0.349206
[INFO   ] Time per step    : 0.052930 s
[INFO   ] =====================================

[INFO   ] =====================================
[INFO   ] StsFindClusters: Run summary
[INFO   ] Events processed   : 10
[INFO   ] Digis / event      : 46.200000
[INFO   ] Clusters / event   : 22.300000
[INFO   ] Digis per cluster  : 2.071749
[INFO   ] Time per event     : 0.000061 s 
[INFO   ] =====================================

[INFO   ] =====================================
[INFO   ] StsFindHits: Run summary
[INFO   ] Events processed  : 10
[INFO   ] Clusters / event  : 22.300000
[INFO   ] Hits / event      : 17.600000
[INFO   ] Hits per cluster  : 0.789238
[INFO   ] Time per event    : 0.000037 
[INFO   ] =====================================

============================================================
=====   STSFindTracks: Run summary 
===== 
===== Good events   : 10    
===== Failed events : 0     
===== Average time  :   0.0013 s
===== 
===== Found tracks per event  : 2
============================================================
Stopwatch: 
tracking: counts=1, real=0/0 s, cpu=0/0
fitter: real=1, real=0/0 s, cpu=0/0

Mirror counter = 0


Macro finished successfully.
Output file is Sim_Outputs/PMTMapping/Rec_RichGeo_jordan_testPmtRot.root
Parameter file is Sim_Outputs/PMTMapping/Parameters_RichGeo_jordan_testPmtRot.root
Real time 4 s, CPU time 3 s

 Test passed
 All ok 
